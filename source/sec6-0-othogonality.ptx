<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec6-0-orthogonality" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Orthogonality</title>
<introduction>
    <p>
        In this chapter we deal with orthogonality of vectors and various properties.
    </p>

<p>
        Recall, that if <m>S=\{v_1,\ldots,
            v_k\}</m> is linearly independent subset of <m>\R^n</m> and <m>v_{k+1}\notin span(S)</m>,
            then <m>S\cup \{v_{k+1}\}=\{v_1,\ldots,
            v_k,v_{k+1}\}</m> is linearly independent subset of <m>\R^n</m>. (why?)
    </p>

</introduction>

  <definition xml:id="def-orthogonal-set">
    <statement>
      <p>
        A set of vectors <m>\{v_1,\ldots,
        v_k\}</m> is called <em>orthogonal</em> if
        <me>
          v_i\cdot v_j = \delta_{ij}=\begin{cases}1 \amp  \text{ if \(i=j\) }  \\ 0 \amp \text{ otherwise } \end{cases}
        </me>
        where <m>u \cdot v </m> represents the standard dot product on <m>\mathbb{R}^n.</m>
      </p>
    </statement>
  </definition>

  <p>
    If <m>x=(x_1,\ldots, x_n) \in \R^n</m>,
    then <m>\norm{x}^2: =x_1^2+\cdots+x_n^2</m>.
  </p>
  
  <exercise xml:id="orth-ex1-0">
    <p> Show that orthogonal set of vectors are linearly independent. </p>
  </exercise>

  <exercise xml:id="orth-ex2-1">
    <statement>
      <p>
        Let <m>\{u_1,\ldots,
        u_k\}</m> be an orthogonal set of vectors in <m>\R^n</m>.
        Let <m>u\in \R^n</m> and define
        <me>
          u_{k+1}:=u-\frac{u_1\cdot u}{\norm{u_1}^2}u_1-\frac{u_2\cdot u}{\norm{u_2}^2}u_2-\cdots -\frac{u_k\cdot u}{\norm{u_k}^2}u_k
        </me>,
      </p>
      <p>
        Then
      </p>
      <p>
        (i) <m>u_i\cdot u_{k+1}=0</m> for all <m>i=1,\ldots, k</m>
      </p>
      <p>
        (ii) If <m>u\notin span(\{u_1,\ldots, u_k\})</m>,
        then <m>u_{k+1}\neq 0</m> and
        <m>\{u_1,\ldots,
        u_k,u_{k+1}\}</m> is an orthogonal set.
      </p>
    </statement>
  </exercise>

   <definition xml:id="def-orthonormal-basis">
    <statement>
      <p>
        A basis <m>\beta =\{u_1,\ldots,
        u_n\}</m> is called an <em> orthogonal basis</em> if <m>\beta</m> is an orthogonal set in <m>\R^n</m>.
        In addition if <m>\norm{u_1}=1</m> for all <m>i</m>,
        then <m>\beta</m> is called an orthonormal basis.
      </p>
    </statement>
  </definition>

  <exercise xml:id="ex-ortho-6-0-0">
    <statement>
      <p>
      <ol>
        <li>
          <p>
            The standard basis <m>{\cal E} = \{e_1,\cdots,
            e_n\}</m> is an orthonormal basis of <m>\R^n</m>.
          </p>
        </li>
        <li>
          <p>
            <m>\beta =\left\{\left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right), \left(\frac{1}{\sqrt{2}},-\frac{1}{\sqrt{2}}\right)\right\}</m> is an orthonormal basis of <m>\R^2</m>.
          </p>
        </li>
        <li>
          <p>
            <m>\beta=\{(2,1,1), (-1,1,1),(0,-1,1)\}</m> is an orthogonal basis of <m>\R^3</m>.
            However, it is not an orthonormal basis.
          </p>
        </li>
        <li>
          <p>
            <m>\beta'=\left\{\left(\frac{2}{\sqrt{6}},\frac{1}{\sqrt{6}},\frac{1}{\sqrt{6}}\right), \left(\frac{-1}{\sqrt{3}},\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}}\right),\left(0,\frac{-1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right)\right\}</m> is an orthonormal basis of <m>\R^n</m>.
          </p>
        </li>
      </ol>
    </p>
    </statement>
  </exercise>

<p>
  <h1> <alert>What is an advantage of having an orthonormal basis?</alert></h1>
</p>

  <p>
    Let <m>\beta =\{u_1,\ldots, u_n\}</m> be an orthonormal basis of <m>\R^n</m> and <m>x\in \R^n</m>.
    Then there exist scalars <m>\alpha_1,\ldots, \alpha_n</m> such that <m>x=\alpha_1u_1+\cdots +\alpha_nu_n</m>.
    Then it is easy to check that <m>\alpha_i = x\cdot u_i</m> for all <m>i</m>. In particular, the scalars <m>\alpha_i</m> can 
    be explicitly written in terms of <m>u</m> and <m>u_i</m>. This is advantage of having an orthonormal basis.
  </p>

  <exercise xml:id="ex-ortho-6-0-1">
    <statement>
      <p>
        (i) Find the coordinates of a vector <m>(1,2)</m> with respect to an orthonormal basis <m>\beta =\left\{\left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right), \left(\frac{1}{\sqrt{2}},-\frac{1}{\sqrt{2}}\right)\right\}</m> of <m>\R^2</m>.
      </p>
      <p>
        (ii) Find the coordinates of the vector <m>(2,5,7)</m> with respect to an orthonormal basis <m>\beta'=\left\{\left(\frac{2}{\sqrt{6}},\frac{1}{\sqrt{6}},\frac{1}{\sqrt{6}}\right), \left(\frac{-1}{\sqrt{3}},\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}}\right),\left(0,\frac{-1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right)\right\}</m> of <m>\R^3</m>.
      </p>
    </statement>
  </exercise>
  <activity>
  <title>Dot Product and Orthogonality in Sage</title>
  <p> 
Sage has a method <c>.dot_product()</c> to find the dot product of two vectors and <c>u.norm()</c> returns the 
norm of <m>u</m>.
  </p>
  
  <sage>
    <input>
      u = vector([1,-1,3,2,-3,1])
      v = vector([2,-1,4,-2,5,-3])
      print(u.dot_product(v))
      print(u.norm())
    </input>
     <output>
       
    </output>
  </sage>
  <p>
    Consider a set of vectors
    <me>
      u_1=(1,1,1,1), u_2=(1,2,-1,-2),u_3=(-7,5,1,1) \in \mathbb{R}^4  
    </me>
    Let us check that <m>u_1,u_2,u_3</m> are orthogonal. Let <m>u=(1,2,3,4)\in \mathbb{R}^4</m>. 
   Define  
    <me>
          u_4:=u-\frac{u_1\cdot u}{\norm{u_1}^2}u_1-\frac{u_2\cdot u}{\norm{u_2}^2}u_2-\frac{u_3\cdot u}{\norm{u_k}^2}u_3.
      </me>
Let us verify that <m>u_4</m> is orthogonal to <m>u_1,u_2,u_3</m>.
  </p>

<sage>
  <input>
    u1=vector([1,1,1,1]);u2=vector([1,2,-1,-2]);u3=vector([-7,5,1,1])
    # Checking orthogonality of u1,u2,u3
    print(u1.dot_product(u2), u1.dot_product(u3),u2.dot_product(u3))
    u = vector([1,2,3,4])
    u4 = u-u.dot_product(u1)/u1.norm()^2*u1-u.dot_product(u2)/u2.norm()^2*u2-u.dot_product(u3)/u3.norm()^2*u3
    print(u4)
    # Checking orthogonality of u1,u2,u3,u
    u4.dot_product(u1), u4.dot_product(u2),u4.dot_product(u3) 
  </input>
  <output>
    
  </output>
</sage>

</activity>
  <exercise xml:id="ex-ortho-6-0-2">
    <p>
 Can you think of how will you generate an orthogonal basis of <m>\mathbb{R}^n</m> starting with a non-zero vector in <m>\mathbb{R}^n</m>?
    </p>
  </exercise>
<p>
    Next we deal with  finding an orthonormal basis of <m>\R^n</m> or any subspace of <m>\R^n</m>.
  </p>
</section>
