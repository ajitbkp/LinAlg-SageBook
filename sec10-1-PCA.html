<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette: blue-green                   *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Principal Component Analysis</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Linear Algebra with SageMath">
<meta property="book:author" content="Ajit Kumar">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.9.8';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.b215b0da62d655bd.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.28cc3c4821792be5.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.8141ae22fd347e48.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body id="changeme" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="linalg-pretext-book.html"><span class="title">Linear Algebra with SageMath</span> <span class="subtitle">A Gentle Introduction</span></a></h1>
<p class="byline">Ajit Kumar</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="chap10-PCA.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="chap10-PCA.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec10-2.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(    \newcommand{\Loadedframemethod}{default}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\inner}[2]{\left\langle #1,#2\right\rangle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\normx}[1]{\left\Vert#1\right\Vert}
\newcommand{\partd}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\innprod}[2]{\left\lt #1,#2\right&gt;}
\def\rank{{ rank\,}}
\newcommand{\ds}{\displaystyle}

\def\diag{{ diag\,}}
\def\proj{{ proj\,}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="front-colophon.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-biography"><div class="toc-title-box"><a href="frontmatter-4.html" class="internal"><span class="title">Author Biography</span></a></div></li>
<li class="toc-item toc-dedication"><div class="toc-title-box"><a href="frontmatter-5.html" class="internal"><span class="title">Dedication</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="preface.html" class="internal"><span class="title">Preface</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap1-lineq.html" class="internal"><span class="codenumber">1</span> <span class="title">System of Linear Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec1-1-elementary-operations.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Elementary Row Operations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-1-elementary-operations.html#subsec-elmentary-row-operations" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Elmentary Row Operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-1-elementary-operations.html#subsec-Matrix-inverse-using-rref" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Matrix Inversion via Elementary Row Operations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec1-2-col-operations.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Elementary Column Operations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec1-3-echelon-form.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Echelon Forms</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-3-echelon-form.html#sec-row-echelon" class="internal"><span class="codenumber">1.3.1</span> <span class="title">Row Echelon Form</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-3-echelon-form.html#subsec-Gaussian-Elimination" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Gaussian Elimination Method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-3-echelon-form.html#subsec-Gauss-Jordan-Method" class="internal"><span class="codenumber">1.3.3</span> <span class="title">Gauss-Jordan elimination method</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec1-4-matrix-rank.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Rank of Matrices</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec1-5-hom-system.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Homogeneous System of Linear Equations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec1-6-LU.html" class="internal"><span class="codenumber">1.6</span> <span class="title"><span class="process-math">\(LU\)</span>-Facotorization</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-6-LU.html#subsec-Doolittle" class="internal"><span class="codenumber">1.6.1</span> <span class="title">Dooliitle and Croutâ€™s Factorization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-6-LU.html#subsec-solving-system-LU" class="internal"><span class="codenumber">1.6.2</span> <span class="title">Solving system of equations using LU factorization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-6-LU.html#subsec-lu-sage" class="internal"><span class="codenumber">1.6.3</span> <span class="title"><span class="process-math">\(LU\)</span>-factorization in Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec1-6-LU.html#subsec-" class="internal"><span class="codenumber">1.6.4</span> <span class="title">User defined functions for DooLitlte and Croutâ€™s Methods</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec1-7-exer.html" class="internal"><span class="codenumber">1.7</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap2-Rn-Space.html" class="internal"><span class="codenumber">2</span> <span class="title"><span class="process-math">\(\R^n\)</span> as a Vector Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec2-0-intro.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Introduction</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec2-1-LinSpan.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Linear Spans</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-2-2-LI.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Linear Dependence</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-2-3-basis-dimension.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Basis and Dimension</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-2-3-basis-dimension.html#subsec-basis-intro" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Basis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-2-3-basis-dimension.html#subsec-dimension-intro" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Dimension of Subspaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-2-3-basis-dimension.html#sec2-3-change-of-basis" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Change of bases.</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec2-4-Sage.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Sage Computations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap3-LT.html" class="internal"><span class="codenumber">3</span> <span class="title">Linear Transformations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec3-1-LT.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Introduction</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec3-2-LT.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Linear maps from <span class="process-math">\(\R^n\)</span> to <span class="process-math">\(\R^m\)</span></span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec3-2-LT.html#sec3-2-LT-RntoRm" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Linear maps from <span class="process-math">\(\R^n\)</span> to <span class="process-math">\(\R^m\)</span></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec3-2-LT.html#sec3-2-LT-composition" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Composition of linear transformations</span></a></div></li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec3-2-LT.html#sec3-2-LT-basis-change" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Matrix of Change of basis</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-reading-questions"><div class="toc-title-box"><a href="sec3-2-LT.html#rqs-uniqueness-of-LT" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Reading Questions</span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec3-3-LT.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Reflections and Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec3-3-LT.html#reflection-R2" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Reflections in <span class="process-math">\(\R^2\)</span></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec3-3-LT.html#projection-R2" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Projections in <span class="process-math">\(\R^2\)</span></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec3-3-LT.html#Proj-Refl-R3" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Projection and Reflection in <span class="process-math">\(\R^3\)</span></span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-LT-Geom.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Geometry of Linear Transformations</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-LT-Geom.html#subsec-image-tranfromation" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Image Tranfromation</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-sec3-5-LT-Sage.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Sage Computations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap4-Vector-Space.html" class="internal"><span class="codenumber">4</span> <span class="title">Vector Spaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec4-1-VS.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec4-2-Abst-VS.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Vector Subspaces</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec4-3-linspan-VS.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Linear Span</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec4-3-LI-VS.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Linear dependence and independence</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec4-5-basis-dim-VS.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Basis and dimension</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec4-5-basis-dim-VS.html#subsec-basis-VS" class="internal"><span class="codenumber">4.5.1</span> <span class="title">Basis of a Vector Space</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec4-5-basis-dim-VS.html#sec4-5-basis-dim-VS-3" class="internal"><span class="codenumber">4.5.2</span> <span class="title">How to find a basis of a finite dimensional vector space?</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec4-5-basis-dim-VS.html#sec4-5-basis-dim-VS-4" class="internal"><span class="codenumber">4.5.3</span> <span class="title">Lagrange Interpolation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec4-5-basis-dim-VS.html#sec4-5-basis-dim-VS-5" class="internal"><span class="codenumber">4.5.4</span> <span class="title">Dimension Formula</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-sec4-5-VS-Sage.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Sage Computations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sec4-5-VS-Sage.html#subsec-Vector-Spaces-Sage" class="internal"><span class="codenumber">4.6.1</span> <span class="title">Vector Spaces in Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sec4-5-VS-Sage.html#subsec-polynomial-space-sage" class="internal"><span class="codenumber">4.6.2</span> <span class="title">Polynomial Space in Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sec4-5-VS-Sage.html#subsec-matrix-space" class="internal"><span class="codenumber">4.6.3</span> <span class="title">Matrix Spaces in Sage</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec4-5-VS-Ex.html" class="internal"><span class="codenumber">4.7</span> <span class="title">Exercise Set</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap5-Eigen.html" class="internal"><span class="codenumber">5</span> <span class="title">Eigenvalues and Eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec5-1-eigen-intro.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Eigenvalues and Eigenvectors</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-reading-questions"><div class="toc-title-box"><a href="sec5-1-eigen-intro.html#rqs-eigenspace-subspace" class="internal"><span class="codenumber">5.1</span> <span class="title">Reading Questions</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec5-2-diagonalization.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Diagonalization</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec5-5-Eigen-Sage.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Eigenvalues and Eigenvectors in Sage</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec5-3-eigen-Appl.html" class="internal"><span class="codenumber">5.4</span> <span class="title">Applications of Eigenvalues and Eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec5-3-eigen-Appl.html#subsec5-3-Fibonacci-Seq" class="internal"><span class="codenumber">5.4.1</span> <span class="title">Fibonacci Sequence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec5-3-eigen-Appl.html#subsec5-3-Predator-Pray" class="internal"><span class="codenumber">5.4.2</span> <span class="title">Predator-Pray Model</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec5-3-eigen-Appl.html#subsec5-3-linear-ode" class="internal"><span class="codenumber">5.4.3</span> <span class="title">Solving System of Linear ODE</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec5-3-eigen-Appl.html#subsec5-3-Markov-Chains" class="internal"><span class="codenumber">5.4.4</span> <span class="title">Markov Chains</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec5-3-eigen-Appl.html#subsec5-3-Google-Search" class="internal"><span class="codenumber">5.4.5</span> <span class="title">Google Search Engine</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec5-4-eigen-exer.html" class="internal"><span class="codenumber">5.5</span> <span class="title">Exercises on Eigenvalues and Eigenvectors</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap5-orthogonality.html" class="internal"><span class="codenumber">6</span> <span class="title">Orthogonality</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec6-0-orthogonality.html" class="internal"><span class="codenumber">6.1</span> <span class="title">Orthogonality</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec6-1-GramSchmidt.html" class="internal"><span class="codenumber">6.2</span> <span class="title">Gram-Schmidt Orthogonalization Process</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec6-2.html" class="internal"><span class="codenumber">6.3</span> <span class="title">Orthogonal Complements</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec6-2.html#subsec-orthogonal-complements" class="internal"><span class="codenumber">6.3.1</span> <span class="title">Orthogonal Complements</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec6-2.html#subsec-Proj-Ref_HyperPlane" class="internal"><span class="codenumber">6.3.2</span> <span class="title">Projection and Reflection</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec6-3.html" class="internal"><span class="codenumber">6.4</span> <span class="title">Orthogonal Diagonalizations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec6-4.html" class="internal"><span class="codenumber">6.5</span> <span class="title">QR-Factorization</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap7-inner-product.html" class="internal"><span class="codenumber">7</span> <span class="title">Inner Product</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec7-1-InnerProduct.html" class="internal"><span class="codenumber">7.1</span> <span class="title">Inner Product</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec7-2-Exer.html" class="internal"><span class="codenumber">7.2</span> <span class="title">Exercise Set</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap8-Least-Square.html" class="internal"><span class="codenumber">8</span> <span class="title">Least Square Problems</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec8-1-LSTSQ.html" class="internal"><span class="codenumber">8.1</span> <span class="title">Least Square Problems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec8-1-LSTSQ.html#sec-linear-lstsq" class="internal"><span class="codenumber">8.1.1</span> <span class="title">Linear Least Square Problems</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec8-1-LSTSQ.html#exercises-LSQ-ex1" class="internal"><span class="codenumber">8.1.1</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec8-1-LSTSQ.html#sec8-1-LSTSQ-4" class="internal"><span class="codenumber">8.1.2</span> <span class="title">Fitting polynomials to a data set</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec8-1-LSTSQ.html#exercises-" class="internal"><span class="codenumber">8.1.2</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec8-1-LSTSQ.html#sec-weigheted-lstsq" class="internal"><span class="codenumber">8.1.3</span> <span class="title">Weighted Least Square Problems</span></a></div></li>
</ul>
</li></ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap9-SVD.html" class="internal"><span class="codenumber">9</span> <span class="title">Singular Value Decomposition</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec9-1-SVD.html" class="internal"><span class="codenumber">9.1</span> <span class="title">Singular Value Decomposition</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec9-1-SVD.html#sec9-1-SVD-3" class="internal"><span class="codenumber">9.1.1</span> <span class="title">Singular Value Decomposition Theorem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-reading-questions"><div class="toc-title-box"><a href="sec9-1-SVD.html#rqs-exer-9-1-15a" class="internal"><span class="codenumber">9.1.1</span> <span class="title">Reading Questions</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec9-1-SVD.html#exercises-SVD-exer-set1" class="internal"><span class="codenumber">9.1.1</span> <span class="title">Exercises</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec9-1-SVD.html#exercises-SVD-exer-set2" class="internal"><span class="codenumber">9.1.1</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-subsection">
<div class="toc-title-box"><a href="sec9-1-SVD.html#sec9-1-SVD-4" class="internal"><span class="codenumber">9.1.2</span> <span class="title">Pseudoinverse using SVD</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-reading-questions"><div class="toc-title-box"><a href="sec9-1-SVD.html#rqs-SVD-psedo-exer-set1" class="internal"><span class="codenumber">9.1.2</span> <span class="title">Reading Questions</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec9-1-SVD.html#exercises-SVD-exer-set3" class="internal"><span class="codenumber">9.1.2</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec9-1-SVD.html#sec9-1-SVD-5" class="internal"><span class="codenumber">9.1.3</span> <span class="title">Geometry of SVD</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec9-1-SVD.html#sec9-1-SVD-6" class="internal"><span class="codenumber">9.1.4</span> <span class="title">Image Compression using SVD</span></a></div></li>
</ul>
</li></ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="chap10-PCA.html" class="internal"><span class="codenumber">10</span> <span class="title">Principal Component Analysis</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec10-1-PCA.html" class="internal"><span class="codenumber">10.1</span> <span class="title">Principal Component Analysis</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-1-PCA.html#subsec10-1-intro-pca" class="internal"><span class="codenumber">10.1.1</span> <span class="title">Introduction</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-1-PCA.html#sec10-1-PCA-4" class="internal"><span class="codenumber">10.1.2</span> <span class="title">Mathematics behind PCA</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec10-2.html" class="internal"><span class="codenumber">10.2</span> <span class="title">Applications of PCA</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-2.html#sec10-2-3" class="internal"><span class="codenumber">10.2.1</span> <span class="title">Image compression with PCA</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-2.html#sec10-2-4" class="internal"><span class="codenumber">10.2.2</span> <span class="title">Relation Between SVD and PCA</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-2.html#sec10-2-5" class="internal"><span class="codenumber">10.2.3</span> <span class="title">Exercise Set</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec10-3.html" class="internal"><span class="codenumber">10.3</span> <span class="title">Sage Practice Area</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec10-3.html#sec-10-3-sage-practice1" class="internal"><span class="codenumber">10.3.1</span> <span class="title">Sage Practice Area</span></a></div></li></ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="appendix-sage-into.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction to Sage</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="appendix-sage-into-3.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Introduction to SageMath</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="getting-started-sagemath.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Getting Started with Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="subsec-sage-programming.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Programming in Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="subsec-plotting-sage.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Plotting in Sage</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="backmatter-3.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec10-1-PCA"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Principal Component Analysis</span>
</h2>
<section class="introduction" id="sec10-1-PCA-2"><div class="para" id="sec10-1-PCA-2-1">In this chapter, we shall explore the concept of pricipal component analysis (PCA) which is somewhat similar to SVD. We shall look at what is similarity between PCA and SVD along with some applications.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div></section><section class="subsection" id="subsec10-1-intro-pca"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.1</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Introduction</span>
</h3>
<div class="para" id="subsec10-1-intro-pca-2">Large datasets with a large number of features/variables are very common and widespread. Interpreting such a large datasets is very complex task. In order to interpret such datasets one requires a method that reduces the dimension/features drastically, at the same time most of the information in the dateset is preserved. The principal component analysis (PCA) is one of the most widely used dimensionality reduction techniques. The main idea of PCA is to reduce the dimensionality in the datasets while preserving much of the variability as much as possible. It does so by creating a new set of uncorrelated variables that successfully maximize the variance. Finding such new variables also known as principal components reduces the problem to solving an eigenvalue-eigenvector problem.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subsec10-1-intro-pca-3">Let us look at the set of points in the plane, (data with two features) in the <a href="sec10-1-PCA.html#fig_pca1" class="xref" data-knowl="./knowl/xref/fig_pca1.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.1">figureÂ 10.1.1</a>. In this case the data has maximum spread or variability along the <span class="process-math">\(y\)</span>-axis. Thus if we project, the points onto the <span class="process-math">\(y\)</span>-axis, the variability in the data can be captured. In particular, we can ignore the <span class="process-math">\(x\)</span>-coordinates. On the other hand if we look at the set of points in the <a href="sec10-1-PCA.html#fig_pca2" class="xref" data-knowl="./knowl/xref/fig_pca2.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.2">figureÂ 10.1.2</a>, maximum spread or variability lies along the <span class="process-math">\(x\)</span>-axis. Thus if we project, the points onto the <span class="process-math">\(x\)</span>-axis, the variability in the data can be captured. In particular, we can ignore the <span class="process-math">\(y\)</span>-coordinates. Thus in these two examples, we are able to reduce the dimension by 1.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="figure figure-like" id="fig_pca1"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig1.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.1<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Variability along <span class="process-math">\(y\)</span>-axis<div class="autopermalink" data-description="Figure 10.1.1"><a href="#fig_pca1" title="Copy heading and permalink for Figure 10.1.1" aria-label="Copy heading and permalink for Figure 10.1.1">ðŸ”—</a></div></figcaption></figure><figure class="figure figure-like" id="fig_pca2"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig2.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.2<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Variability along <span class="process-math">\(x\)</span>-axis<div class="autopermalink" data-description="Figure 10.1.2"><a href="#fig_pca2" title="Copy heading and permalink for Figure 10.1.2" aria-label="Copy heading and permalink for Figure 10.1.2">ðŸ”—</a></div></figcaption></figure><div class="para" id="subsec10-1-intro-pca-6">Now suppose we have 12 points as show in the <a href="sec10-1-PCA.html#fig_pca3" class="xref" data-knowl="./knowl/xref/fig_pca3.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.3">FigureÂ 10.1.3</a> again in <span class="process-math">\(\R^2\text{,}\)</span> that is having two features/dimensions. The spread of this data seems to be not along <span class="process-math">\(x\)</span>-axis but roughly along the axis as shown in the <a href="sec10-1-PCA.html#fig_pca4" class="xref" data-knowl="./knowl/xref/fig_pca4.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.4">FigureÂ 10.1.4</a>, that is, along the vector <span class="process-math">\(u_1\text{.}\)</span> So if we project these points on the line along <span class="process-math">\(u_1\)</span> as shown in the <a href="sec10-1-PCA.html#fig_pca4" class="xref" data-knowl="./knowl/xref/fig_pca4.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.4">FigureÂ 10.1.4</a>, we will have maximum spread or variation of the data. Thus <span class="process-math">\(u_1\)</span> is the new axis along which the data has maximum variation.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="figure figure-like" id="fig_pca3"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig3.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.3<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Data with two features.<div class="autopermalink" data-description="Figure 10.1.3"><a href="#fig_pca3" title="Copy heading and permalink for Figure 10.1.3" aria-label="Copy heading and permalink for Figure 10.1.3">ðŸ”—</a></div></figcaption></figure><figure class="figure figure-like" id="fig_pca4"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig4.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.4<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Variability along vector <span class="process-math">\(u_1\text{.}\)</span><div class="autopermalink" data-description="Figure 10.1.4"><a href="#fig_pca4" title="Copy heading and permalink for Figure 10.1.4" aria-label="Copy heading and permalink for Figure 10.1.4">ðŸ”—</a></div></figcaption></figure><div class="para" id="subsec10-1-intro-pca-9">Next if one carefully looks into the data points, one can see that the data also has some dispersion or variation along the line given by the direction <span class="process-math">\(u_2\)</span> as shown in the <a href="sec10-1-PCA.html#fig_pca5" class="xref" data-knowl="./knowl/xref/fig_pca5.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.5">FigureÂ 10.1.5</a> and which is not captured by the line along <span class="process-math">\(u_1\text{.}\)</span> In a way, we need to create another axis which is perpendicular to the 1st one.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="subsec10-1-intro-pca-10">Thus we have two perpendicular coordinate axes or a new coordinates system along which all the variations in the data can be captured. In this case, maximum variation along <span class="process-math">\(u_1\)</span> and second maximum along <span class="process-math">\(u_2\text{.}\)</span> Here <span class="process-math">\(u_1\)</span> is called the first principal direction and <span class="process-math">\(u_2\)</span> is called the second principal direction. Thus we can work with new coordinate axes and forget about the original <span class="process-math">\(x\)</span> and <span class="process-math">\(y\)</span>-axes as show in the <a href="sec10-1-PCA.html#fig_pca6" class="xref" data-knowl="./knowl/xref/fig_pca6.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.6">FigureÂ 10.1.6</a>. We can even rotate the new coordinate system that coincides with original <span class="process-math">\(x\)</span> and <span class="process-math">\(y\)</span>-axes.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-10" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="figure figure-like" id="fig_pca5"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig5.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.5<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>1st and 2nd principal components <span class="process-math">\(u_1\)</span> and <span class="process-math">\(u_2\text{.}\)</span><div class="autopermalink" data-description="Figure 10.1.5"><a href="#fig_pca5" title="Copy heading and permalink for Figure 10.1.5" aria-label="Copy heading and permalink for Figure 10.1.5">ðŸ”—</a></div></figcaption></figure><figure class="figure figure-like" id="fig_pca6"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/PCA-Fig6.PNG" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.6<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>1st and 2nd principal components <span class="process-math">\(u_1\)</span> and <span class="process-math">\(u_2\text{.}\)</span><div class="autopermalink" data-description="Figure 10.1.6"><a href="#fig_pca6" title="Copy heading and permalink for Figure 10.1.6" aria-label="Copy heading and permalink for Figure 10.1.6">ðŸ”—</a></div></figcaption></figure><div class="para" id="subsec10-1-intro-pca-13">The above two examples, geometrically explains the essence of PCA. The idea is to project the original high dimensional data to a new coordinate system and choose only first we coordinates axes also called principal components. How many principal component to be taken depends upon how much variation we wish to capture.<div class="autopermalink" data-description="Paragraph"><a href="#subsec10-1-intro-pca-13" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Subsection 10.1.1: Introduction"><a href="#subsec10-1-intro-pca" title="Copy heading and permalink for Subsection 10.1.1: Introduction" aria-label="Copy heading and permalink for Subsection 10.1.1: Introduction">ðŸ”—</a></div></section><section class="subsection" id="sec10-1-PCA-4"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.2</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="title">Mathematics behind PCA</span>
</h3>
<div class="para logical" id="sec10-1-PCA-4-2">
<div class="para">Let us assume that we have a data which has <span class="process-math">\(d\)</span> features and there are <span class="process-math">\(n\)</span> of them. This data can be represented by a <span class="process-math">\(n\times d\)</span> matrix, say <span class="process-math">\(X\text{.}\)</span> Thus</div>
<div class="displaymath process-math">
\begin{equation*}
X = \begin{bmatrix}x_{11} \amp  x_{12} \amp  \cdots \amp  x_{1d}\\ x_{21} \amp  x_{22} \amp  \cdots \amp  x_{2d}\\ \vdots \amp  \vdots \amp  \ddots \amp  \vdots\\ x_{n1} \amp  x_{n2} \amp  \cdots \amp  x_{nd} \end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">Thus each columns of <span class="process-math">\(X\)</span> represents a feature and there are <span class="process-math">\(n\)</span> samples for each feature.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec10-1-PCA-4-3">Now we are looking for an unit vector <span class="process-math">\(u_1\)</span> and we wish to project the data onto <span class="process-math">\(u_1\)</span> such that the variance of the projected data is maximum.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-4">
<div class="para">Before we explain that in generality, let us look at what is meaning of projection of data in 2 dimension (that is in <span class="process-math">\(\R^2\)</span>) on an unit vector. Suppose <span class="process-math">\(u=(a,b)\)</span> is an unit vector ad <span class="process-math">\(p_1=(x_1,y_1)\)</span> be a point/vector in <span class="process-math">\(\R^2\text{.}\)</span> Then</div>
<div class="displaymath process-math">
\begin{equation*}
\proj_u(p_1)=\frac{p_1\cdot u}{\norm{u}^2}u=(x_1a+x_2b)u\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-5">
<div class="para">The length of the projection is <span class="process-math">\(p_1x_2+p_2x_2\text{.}\)</span> If we have another point, say <span class="process-math">\(p_2 =(x_2,y_2)\text{,}\)</span> then the projection of both these points can be captured as</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{bmatrix}x_1 \amp  x_2 \\y_1 \amp  y_2 \end{bmatrix}  \begin{bmatrix}a\\b \end{bmatrix}  = Xu\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-6">
<div class="para">Thus in general the projection of data <span class="process-math">\(X\)</span> which is <span class="process-math">\(n\times p\)</span> matrix onto a unit vector <span class="process-math">\(u_1=\begin{bmatrix}u_{11}\amp  u_{12}\amp \cdots \amp  u_{1d} \end{bmatrix} ^T\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
X = \begin{bmatrix}x_{11} \amp  x_{12} \amp  \cdots \amp  x_{1d}\\ x_{21} \amp  x_{22} \amp  \cdots \amp  x_{2d}\\ \vdots \amp  \vdots \amp  \ddots \amp  \vdots\\ x_{n1} \amp  x_{n2} \amp  \cdots \amp  x_{nd} \end{bmatrix} \begin{bmatrix}u_{11}\\ u_{12}\\\vdots \\u_{1d} \end{bmatrix} =Xu_1\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-7">
<div class="para">Next we deal with the second issue in PCA, namely, â€™varianceâ€™. For this we take the centered data <span class="process-math">\(X_c =X-\overline{X}\text{,}\)</span> where <span class="process-math">\(\overline{X}=\frac{1}{d}\begin{bmatrix}x_{11}+x_{12}+\cdots+x_{1d}\\ x_{21}+x_{22}+\cdots+x_{2d}\\\vdots\\x_{1n}+x_{1n}+\cdots+x_{1n} \end{bmatrix}\text{.}\)</span> The covariance of <span class="process-math">\(X\text{,}\)</span> is given</div>
<div class="displaymath process-math">
\begin{equation*}
S ={ Cov}(X)=\frac{1}{n-1}{X_c}^TX_c\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-8">
<div class="para">Note that (i) <span class="process-math">\(S\)</span> is symmetric and (ii) Semi-positive definite, all eigenvalues of <span class="process-math">\(S\)</span> are non negative. Also <span class="process-math">\(S\)</span> is orthogonally diagonalizable. In particular, there exists an orthogonal matrix <span class="process-math">\(U = \begin{bmatrix}u_1\amp u_2\amp \cdots \amp  u_d \end{bmatrix}\)</span> such that <span class="process-math">\(U^TSU = { diag }(\lambda_1,\cdots,\lambda_p)\text{.}\)</span> What we wanted was to maximize the variance of projection of the data onto unit vector <span class="process-math">\(u\text{.}\)</span> That is, we want to find an unit vector <span class="process-math">\(u\)</span> such that the variance of <span class="process-math">\(X_cu\)</span> is maximum. In other words,</div>
<div class="displaymath process-math" id="sec10-1-PCA-4-8-9">
\begin{align*}
\text{maximize }\amp \frac{1}{n-1}(X_cu)^T{X_cu}=\frac{1}{n-1}u^T(X_c^TX_c)u=u^TSu\\
\text{subject to } \amp  \norm{u}=1\text{.}
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec10-1-PCA-4-9">It turns out that the solution of this optimization problem is <span class="process-math">\(u\text{,}\)</span> which is the eigenvector of <span class="process-math">\(S\text{.}\)</span> Thus the variance of the projected data onto a unit vector is maximum if <span class="process-math">\(u\)</span> happens to be an eigenvector of the covariance matrix <span class="process-math">\(S\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec10-1-PCA-4-10">Note that <span class="process-math">\(S\)</span> is of order <span class="process-math">\(d\times d\)</span> which has <span class="process-math">\(d\)</span> linearly independent eigenvectors. We arrange these eigenvector corresponding to the decreasing eigenvalues. That <span class="process-math">\(u_1\)</span> is the eigenvector corresponding to the largest eigenvector <span class="process-math">\(\lambda_1\)</span> and is called the first principal component. The eigenvector <span class="process-math">\(u_2\)</span> corresponding to the second highest eigenvalue <span class="process-math">\(\lambda_2\text{,}\)</span> is called the second principal component. Thus if we project data onto the second principal component that it will have second higher variance. Look at <a href="sec10-1-PCA.html#fig_data_pca" class="xref" data-knowl="./knowl/xref/fig_data_pca.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.7">FigureÂ 10.1.7</a> in which the data is plotted along with the principal components. The <a href="sec10-1-PCA.html#fig_datapac_proj" class="xref" data-knowl="./knowl/xref/fig_datapac_proj.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 10.1.8">FigureÂ 10.1.8</a>, the data projected on the 1st component of PCA is plotted along with the data.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-10" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="figure figure-like" id="fig_data_pca"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/data_pca.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.7<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Data set with principal components<div class="autopermalink" data-description="Figure 10.1.7"><a href="#fig_data_pca" title="Copy heading and permalink for Figure 10.1.7" aria-label="Copy heading and permalink for Figure 10.1.7">ðŸ”—</a></div></figcaption></figure><figure class="figure figure-like" id="fig_datapac_proj"><div class="image-box" style="width: 45%; margin-left: 27.5%; margin-right: 27.5%;"><img src="external/images/datapca_proj.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.8<span class="period heading-divison-mark heading-divison-mark__period">.</span></span><span class="space heading-divison-mark heading-divison-mark__space"> </span>Projection on 1st PCA components<div class="autopermalink" data-description="Figure 10.1.8"><a href="#fig_datapac_proj" title="Copy heading and permalink for Figure 10.1.8" aria-label="Copy heading and permalink for Figure 10.1.8">ðŸ”—</a></div></figcaption></figure><div class="para logical" id="sec10-1-PCA-4-13">
<div class="para">Next question is how many principal components, we should choose. This depends upon what percentage of variance of the data we wish to capture. Suppose we want to capture 90% variations, the we choose the 1st <span class="process-math">\(k\)</span> components such that</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\sum_{i=1}^k \lambda_i}{\sum_{j=1}^d\lambda_j}\geq 0.9\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-13" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec10-1-PCA-4-14">
<div class="para">The projected data onto the 1st <span class="process-math">\(k\)</span> principal components is given by</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{bmatrix}x_{11} \amp  x_{12} \amp  \cdots \amp  x_{1d}\\ x_{21} \amp  x_{22} \amp  \cdots \amp  x_{2d}\\ \vdots \amp  \vdots \amp  \ddots \amp  \vdots\\ x_{n1} \amp  x_{n2} \amp  \cdots \amp  x_{nd} \end{bmatrix} \begin{bmatrix}u_1\amp u_2\amp \cdots \amp  u_k \end{bmatrix} =XV= \begin{bmatrix}z_{11} \amp  z_{12} \amp  \cdots \amp  z_{1k}\\ z_{21} \amp  z_{22} \amp  \cdots \amp  z_{2k}\\ \vdots \amp  \vdots \amp  \ddots \amp  \vdots\\ z_{n1} \amp  z_{n2} \amp  \cdots \amp  z_{nk} \end{bmatrix} =Z
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-14" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec10-1-PCA-4-15">Here <span class="process-math">\(V\)</span> is called the loading matrix. The new data or transformed data <span class="process-math">\(Z=XV\text{.}\)</span> Once we know the transformed data then we can construct the original data by <span class="process-math">\(X=ZV^T\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-15" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<article class="example example-like" id="sec10-1-PCA-4-16"><h4 class="heading">
<span class="type">Example</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.9</span><span class="period heading-divison-mark heading-divison-mark__period">.</span>
</h4>
<div class="para" id="sec10-1-PCA-4-16-1-1">Consider the following 2 dimensional data.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="l m b2 r3 l3 t3 lines"><span class="process-math">\(x_1\)</span></td>
<td class="l m b2 r3 l0 t3 lines">2.5</td>
<td class="l m b2 r3 l0 t3 lines">0.5</td>
<td class="l m b2 r3 l0 t3 lines">2.2</td>
<td class="l m b2 r3 l0 t3 lines">1.9</td>
<td class="l m b2 r3 l0 t3 lines">3.0</td>
<td class="l m b2 r3 l0 t3 lines">2.3</td>
<td class="l m b2 r3 l0 t3 lines">2.0</td>
<td class="l m b2 r3 l0 t3 lines">1.0</td>
<td class="l m b2 r3 l0 t3 lines">1.5</td>
<td class="l m b2 r2 l0 t3 lines">1.1</td>
</tr>
<tr>
<td class="l m b2 r3 l3 t0 lines"><span class="process-math">\(x_2\)</span></td>
<td class="l m b2 r3 l0 t0 lines">2.0</td>
<td class="l m b2 r3 l0 t0 lines">0.7</td>
<td class="l m b2 r3 l0 t0 lines">2.9</td>
<td class="l m b2 r3 l0 t0 lines">2.2</td>
<td class="l m b2 r3 l0 t0 lines">2.8</td>
<td class="l m b2 r3 l0 t0 lines">2.7</td>
<td class="l m b2 r3 l0 t0 lines">1.6</td>
<td class="l m b2 r3 l0 t0 lines">1.1</td>
<td class="l m b2 r3 l0 t0 lines">1.6</td>
<td class="l m b2 r2 l0 t0 lines">0.9</td>
</tr>
</table></div> <div class="para" id="sec10-1-PCA-4-16-1-3">Find the first and the second principal components of this data set. Explain what percentage of variance os explained by the 1st principal component.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="sec10-1-PCA-4-16-1-4">
<div class="para">The <span class="process-math">\(\overline{x_1} =1.8\)</span> and <span class="process-math">\(\overline{x_2}=1.85\text{.}\)</span> The centered data set is</div>
<div class="displaymath process-math">
\begin{equation*}
X_c = X - \begin{bmatrix}\overline{x_1}\\\overline{x_2} \end{bmatrix} =\left(\begin{array}{rr} 0.7 \amp  0.15 \\ -1.3 \amp  -1.15\\ 0.4 \amp  1.05\\ 0.1 \amp  0.35 \\ 1.2 \amp  0.95 \\ 0.5\amp  0.85 \\ 0.2 \amp  -0.25\\ -0.8 \amp  -0.75 \\ -0.3 \amp  -0.25 \\ -0.7 \amp  -0.95 \end{array} \right)
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="sec10-1-PCA-4-16-1-5">
<div class="para">Next we construct the covariance matrix of <span class="process-math">\(X\text{,}\)</span> which is</div>
<div class="displaymath process-math">
\begin{equation*}
S = \frac{1}{10-1}X_c^TX_c=\left(\begin{array}{rr} 0.589 \amp  0.546 \\ 0.546 \amp  0.643 \end{array} \right)
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para" id="sec10-1-PCA-4-16-1-6">The eigenvalues of <span class="process-math">\(S\)</span> are eigenvalues <span class="process-math">\(\lambda_1 =1.1620\)</span> and <span class="process-math">\(\lambda_2=0.0696\text{.}\)</span> The corresponding eigenvectors are <span class="process-math">\(u_1 = \begin{pmatrix}0.6894\\0.7243 \end{pmatrix}\)</span> and <span class="process-math">\(u_2 = \begin{pmatrix}0.7243\\-0.689 \end{pmatrix}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="sec10-1-PCA-4-16-1-7">
<div class="para">Hence the loading matrix <span class="process-math">\(V\)</span> is given by</div>
<div class="displaymath process-math">
\begin{equation*}
V = \left(\begin{array}{rr} 0.6894 \amp  0.7243 \\ 0.7243 \amp  -0.6894 \end{array} \right)\text{.}
\end{equation*}
</div>
<div class="para">The projected data on the 1st two principal components is</div>
<div class="displaymath process-math">
\begin{equation*}
Z = X_cV = \left(\begin{array}{rr} 0.591 \amp  0.404 \\ -1.73 \amp  -0.149 \\ 1.04 \amp  -0.434 \\ 0.322 \amp  -0.169 \\ 1.52 \amp  0.214 \\ 0.960 \amp  -0.224 \\ -0.0432 \amp  0.317 \\ -1.09 \amp  -0.0624 \\ -0.388 \amp  -0.0449 \\ -1.17 \amp  0.148 \end{array} \right)
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="sec10-1-PCA-4-16-1-8">
<div class="para">We can recover the original data set by</div>
<div class="displaymath process-math">
\begin{equation*}
ZV^T+\left(\begin{array}{rr} 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \\ 1.80 \amp  1.85 \end{array} \right)=X
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="sec10-1-PCA-4-16-1-9">
<div class="para">The variance explained by the 1st principal component is</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\lambda_1}{\lambda_1+\lambda_2}\approx 0.9435
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para" id="sec10-1-PCA-4-16-1-10">Thus approximately 94.35% variance is captured by the 1st principal component.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-16-1-10" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Example 10.1.9"><a href="#sec10-1-PCA-4-16" title="Copy heading and permalink for Example 10.1.9" aria-label="Copy heading and permalink for Example 10.1.9">ðŸ”—</a></div></article><div class="para" id="sec10-1-PCA-4-17">Let us solve the above problem in Sage.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-17" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div id="sec10-1-PCA-4-18" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">xx = [2.5,0.5,2.2,1.9,3.0,2.3,2.0,1.0,1.5,1.1]
yy = [2.0,0.7,2.9,2.2,2.8,2.7,1.6,1.1,1.6,0.9]
X = column_matrix([xx,yy])
n = len(xx)
d = 2
</script></div>
<div class="para" id="sec10-1-PCA-4-19">Next we plot the set of points.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-19" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div id="sec10-1-PCA-4-20" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">pts = points([(xx[i],yy[i]) for i in range(n)],size=10)
show(pts,axes=(0,0),xmin=-0.2,ymin=-0.2,figsize=4)
</script></div>
<div id="sec10-1-PCA-4-21" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">xxm = mean(xx)
yym = mean(yy)
print(xxm.n(digits=3),yym.n(digits=3))    
mean_matrix = column_matrix([[xxm for i in range(n)],[yym for i in range(n)]])
Xc = X-mean_matrix;
Xc.n(digits=2)
</script></div>
<div id="sec10-1-PCA-4-22" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">mean_pts = points(Xc,size=10,color='blue');mean_pts
</script></div>
<div id="sec10-1-PCA-4-23" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">S = 1/(n-1)*(Xc.T)*Xc
print('The Covariance matrix is')
S = S.change_ring(CDF)
eigenvalues = S.eigenvalues()
print('The principal components are:')
print(eigenvalues)
print('The Eigenvectors of covariance matrix are')
evec=S.eigenvectors_right();
print(evec)
</script></div>
<div id="sec10-1-PCA-4-24" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">pc1 = evec[1][1][0]
pc2 = evec[0][1][0]
</script></div>
<div id="sec10-1-PCA-4-25" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"> pca_plot = (2*pc1).plot(color='green')+pc2.plot(color='red')+mean_pts
show(pca_plot,aspect_ratio=1)
</script></div>
<div id="sec10-1-PCA-4-26" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">V = column_matrix([pc1,pc2])
Z = Xc*V; 
print(Z)
</script></div>
<div id="sec10-1-PCA-4-27" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"> X1 = Z*V.T;
X1.n(digits=3)
print(X1)
</script></div>
<div id="sec10-1-PCA-4-28" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">print(Z*V+mean_matrix)
</script></div>
<div id="sec10-1-PCA-4-29" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">## Variance explaines by the 1st PAC.
eigenvalues[1]/(sum(eigenvalues))*100
</script></div>
<article class="example example-like" id="pca-eg2"><h4 class="heading">
<span class="type">Example</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">10.1.10</span><span class="period heading-divison-mark heading-divison-mark__period">.</span>
</h4>
<div class="para" id="pca-eg2-1-1">Consider the following data in 3-dimension.<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para" id="pca-eg2-1-2">
<div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(x_1\)</span></td>
<td class="l m b0 r0 l0 t0 lines">24</td>
<td class="l m b0 r0 l0 t0 lines">8</td>
<td class="l m b0 r0 l0 t0 lines">21</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">9</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">8</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines">4</td>
<td class="l m b0 r0 l0 t0 lines">12</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(x_2\)</span></td>
<td class="l m b0 r0 l0 t0 lines">13</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">6</td>
<td class="l m b0 r0 l0 t0 lines">14</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">16</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines">6</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b1 r0 l0 t0 lines"><span class="process-math">\(x_3\)</span></td>
<td class="l m b1 r0 l0 t0 lines">38</td>
<td class="l m b1 r0 l0 t0 lines">17</td>
<td class="l m b1 r0 l0 t0 lines">40</td>
<td class="l m b1 r0 l0 t0 lines">-9</td>
<td class="l m b1 r0 l0 t0 lines">21</td>
<td class="l m b1 r0 l0 t0 lines">14</td>
<td class="l m b1 r0 l0 t0 lines">11</td>
<td class="l m b1 r0 l0 t0 lines">3</td>
<td class="l m b1 r0 l0 t0 lines">2</td>
<td class="l m b1 r0 l0 t0 lines">30</td>
<td class="l m b1 r0 l0 t0 lines">1</td>
<td class="l m b1 r0 l0 t0 lines">18</td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(x_1\)</span></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">5</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">21</td>
<td class="l m b0 r0 l0 t0 lines">8</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines">16</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">14</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">5</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(x_2\)</span></td>
<td class="l m b0 r0 l0 t0 lines">9</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">12</td>
<td class="l m b0 r0 l0 t0 lines">9</td>
<td class="l m b0 r0 l0 t0 lines">8</td>
<td class="l m b0 r0 l0 t0 lines">18</td>
<td class="l m b0 r0 l0 t0 lines">8</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines">0</td>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">6</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(x_3\)</span></td>
<td class="l m b0 r0 l0 t0 lines">-4</td>
<td class="l m b0 r0 l0 t0 lines">19</td>
<td class="l m b0 r0 l0 t0 lines">13</td>
<td class="l m b0 r0 l0 t0 lines">-6</td>
<td class="l m b0 r0 l0 t0 lines">34</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">-18</td>
<td class="l m b0 r0 l0 t0 lines">25</td>
<td class="l m b0 r0 l0 t0 lines">29</td>
<td class="l m b0 r0 l0 t0 lines">17</td>
<td class="l m b0 r0 l0 t0 lines">31</td>
<td class="l m b0 r0 l0 t0 lines">0</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
</tr>
</table></div>
<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="pca-eg2-1-3">
<div class="para">The mean of each feature are <span class="process-math">\(\overline{x_1}=8.96, \overline{x_2}=7.081,\overline{x_2}=3.6\text{.}\)</span> We have</div>
<div class="displaymath process-math">
\begin{equation*}
X= \left(\begin{array}{rrr} 24 \amp  13 \amp  38 \\ 8 \amp  3 \amp  17 \\\vdots \amp  \vdots \amp  \vdots \\ 5 \amp  6 \amp  7 \end{array} \right), X -\overline{X} = \left(\begin{array}{rrr} 15.04 \amp  5.92 \amp  24.4 \\ -0.96 \amp  -4.08 \amp  3.4 \\\vdots \amp  \vdots \amp \vdots\\ -3.96 \amp  -1.08 \amp  -6.6 \end{array} \right)
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="pca-eg2-1-4">
<div class="para">The covariance matrix of <span class="process-math">\(X\)</span> is given by</div>
<div class="displaymath process-math" id="pca-eg2-1-4-2">
\begin{align*}
{ Cov}(X)=S=\amp \frac{1}{n-1}(X -\overline{X})^T(X -\overline{X})\\
=\amp \left(\begin{array}{rrr} 45.7066 \amp  -0.2466\amp  94.8583 \\ -0.2466 \amp  24.0766 \amp  -29.175 \\ 94.8583\amp  -29.175 \amp  235.9166 \end{array} \right)
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="pca-eg2-1-5">
<div class="para">The eigenvalues of <span class="process-math">\(S\)</span> are <span class="process-math">\(\lambda_1=278.02366293, \lambda_2=26.95307696, \lambda_3=0.72326011\text{.}\)</span> The corresponding eigenvectors are</div>
<div class="displaymath process-math">
\begin{equation*}
pc_1=\left(\begin{array}{r} 0.3759787 \\ -0.10612 \\ 0.920531 \end{array} \right), pc_2=\left(\begin{array}{r} 0.46959\\ 0.87822 \\ -0.09055 \end{array} \right), pc_3=\left(\begin{array}{r} 0.79882 \\ -0.4663\\ -0.38003 \end{array} \right)\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div> <div class="para logical" id="pca-eg2-1-6">
<div class="para">The percentage of variance explained by the first principal component is</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\lambda_1}{\lambda_1+\lambda_2+\lambda_3}\approx 0.9094\approx  90.94%
\end{equation*}
</div>
<div class="para">The percentage of variance explained by the first two principal components is</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\lambda_1+\lambda_2}{\lambda_1+\lambda_2+\lambda_3}\approx 0.997=99.7%
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#pca-eg2-1-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Example 10.1.10"><a href="#pca-eg2" title="Copy heading and permalink for Example 10.1.10" aria-label="Copy heading and permalink for Example 10.1.10">ðŸ”—</a></div></article><div class="para" id="sec10-1-PCA-4-31">Let us solve the above problem in Sage.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-31" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div id="sec10-1-PCA-4-32" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">import numpy as np
X = np.array([[24, 13, 38], [8, 3, 17], [21, 6, 40], [1, 14, -9], [9, 3, 21], [7, 1, 14],
              [8, 7, 11], [10, 16, 3], [1, 3, 2], [15, 2, 30], [4, 6, 1], [12, 10, 18], [1, 9, -4],
              [7, 3, 19], [5, 1, 13], [1, 12, -6], [21, 9, 34], [8, 8, 7], [1, 18, -18],
              [15, 8, 25], [16, 10, 29], [7, 0, 17], [14, 2, 31], [3, 7, 0], [5, 6, 7]])
</script></div>
<div id="sec10-1-PCA-4-33" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">u = X[:,0] # First column of X
v = X[:,1] # Second column of X
w = X[:,2] # Third column of X
n = len(u)
u_bar = np.mean(u) # Mean of the first column
v_bar = np.mean(v) # Mean of the second column
w_bar = np.mean(w) # Mean of the third column
u1=u-u_bar 
v1 = v-v_bar
w1 = w-w_bar
X_bar = np.array([u1,v1,w1]).T # Adjusted data
X1 = X-np.mean(X,axis=0) # Adjusted data
S1 = 1/(n-1)*(X1.T).dot(X1)
print(f'The covaraince matrix is:\n {S1}')
eigens = np.linalg.eigvals(S1)
print(f'Eigenvalues of the covariance matrix are:\n{eigens}')
</script></div>
<div id="sec10-1-PCA-4-34" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">eig_val,eig_vec= np.linalg.eig(S1)
print('Eigenvalues are:',eig_val)
print('Matrix of eigenvectors:',eig_vec)
print("Eigenvectors are:", eig_vec[:,0], 'and', eig_vec[:,1], eig_vec[:,2])
</script></div>
<div id="sec10-1-PCA-4-35" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">S1 = matrix(S1).change_ring(CDF)
S1.eigenmatrix_right()
</script></div>
<div id="sec10-1-PCA-4-36" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">evec=S1.eigenvectors_right();
print(evec)
pc1 = evec[0][1][0]
pc2 = evec[2][1][0]
pc3 = evec[1][1][0];pc3
print('The pricipal components are')
print(pc1,pc2,pc3)
</script></div>
<div id="sec10-1-PCA-4-37" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># Variance explained by the 1st PCA 
eig_val[0]/sum(eig_val)*100
</script></div>
<div id="sec10-1-PCA-4-38" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># Variance explained by the 1st two PCAs
(eig_val[0]+eig_val[2])/sum(eig_val)*100
</script></div>
<div class="para" id="sec10-1-PCA-4-39">We can vizualize the PCA in the 3d. We use a simulated data of 200 points in 3d.<div class="autopermalink" data-description="Paragraph"><a href="#sec10-1-PCA-4-39" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div id="sec10-1-PCA-4-40" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">import numpy as np

# Seed for reproducibility
np.random.seed(42)

# Generate 3D data with correlation
# First principal axis is along (1, 2, 0.5)
n_points = 200
t = np.linspace(-5, 5, n_points)
x = t + np.random.normal(0, 0.5, n_points)
y = 2*t + np.random.normal(0, 0.5, n_points)
z = 0.5*t + np.random.normal(0, 0.5, n_points)

X = np.vstack((x, y, z)).T

# Mean-center
X_mean = np.mean(X, axis=0)
X_centered = X - X_mean

# Covariance matrix
cov_matrix = np.cov(X_centered, rowvar=False)

# Eigen decomposition
eigenvalues, eigenvectors = np.linalg.eigh(cov_matrix)

# Sort by descending eigenvalue
idx = np.argsort(eigenvalues)[::-1]
eigenvalues = eigenvalues[idx]
eigenvectors = eigenvectors[:, idx]

# Scale for plotting
scale = 3
pc_vectors = [scale*np.sqrt(ev)*vec for ev, vec in zip(eigenvalues, eigenvectors.T)]

# Plot points
points3d_list = [point3d(p, size=20, color='blue') for p in X_centered]

# Plot principal component arrows
origin = vector([0, 0, 0])
pca_arrows = [arrow3d(origin, vector(v), color='red', width=2) for v in pc_vectors]

# Show plot
p = sum(points3d_list) + sum(pca_arrows)
p.show(viewer='threejs', frame=True)
</script></div>
<div class="autopermalink" data-description="Subsection 10.1.2: Mathematics behind PCA"><a href="#sec10-1-PCA-4" title="Copy heading and permalink for Subsection 10.1.2: Mathematics behind PCA" aria-label="Copy heading and permalink for Subsection 10.1.2: Mathematics behind PCA">ðŸ”—</a></div></section><div class="autopermalink" data-description="Section 10.1: Principal Component Analysis"><a href="#sec10-1-PCA" title="Copy heading and permalink for Section 10.1: Principal Component Analysis" aria-label="Copy heading and permalink for Section 10.1: Principal Component Analysis">ðŸ”—</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="chap10-PCA.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec10-2.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
