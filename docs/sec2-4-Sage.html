<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2025-08-18T19:42:29+05:30       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sage Computations</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Linear Algebra with SageMath">
<meta property="book:author" content="Ajit Kumar">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
    renderActions: {
        findScript: [10, function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        }, '']
    },
  },
  chtml: {
    scale: 0.88,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script>miniversion=0.674</script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/style_oscarlevin.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/setcolors.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX Course: Title Here';
eBookConfig.basecourse = 'PTX Base Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.acDefaultLanguage = 'python';
eBookConfig.runestone_version = '5.0.1';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/runtime.b0f8547c48f16a9f.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/637.d54be67956c5c660.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/runestone.0e9550fe42760516.bundle.js"></script><link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/6.2.1/637.fafafbd97df8a0d1.css">
<link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/6.2.1/runestone.e4d5592da655219f.css">
</head>
<body id="changeme" class="pretext-book ignore-math has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(    \newcommand{\Loadedframemethod}{default}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\inner}[2]{\left\langle #1,#2\right\rangle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\normx}[1]{\left\Vert#1\right\Vert}
\newcommand{\partd}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\innprod}[2]{\left\lt #1,#2\right&gt;}
\def\rank{{ rank\,}}
\newcommand{\ds}{\displaystyle}

\def\diag{{ diag\,}}
\def\proj{{ proj\,}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="linalg-pretext-book.html"><span class="title">Linear Algebra with SageMath:</span> <span class="subtitle">A Gentle Introduction</span></a></h1>
<p class="byline">Ajit Kumar</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec-2-3-basis-dimension.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chap2-Rn-Space.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="chap3-LT.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec-2-3-basis-dimension.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chap2-Rn-Space.html" title="Up">Up</a><a class="next-button button toolbar-item" href="chap3-LT.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter.html" data-scroll="frontmatter" class="internal"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1" class="internal">Colophon</a></li>
<li><a href="biography-1.html" data-scroll="biography-1" class="internal">Author Biography</a></li>
<li><a href="dedication-1.html" data-scroll="dedication-1" class="internal">Dedication</a></li>
<li><a href="preface.html" data-scroll="preface" class="internal">Preface</a></li>
</ul>
</li>
<li class="link">
<a href="chap1-lineq.html" data-scroll="chap1-lineq" class="internal"><span class="codenumber">1</span> <span class="title">System of Linear Equations</span></a><ul>
<li><a href="sec1-1-elementary-operations.html" data-scroll="sec1-1-elementary-operations" class="internal">Elementary Row Operations</a></li>
<li><a href="sec1-2-col-operations.html" data-scroll="sec1-2-col-operations" class="internal">Elementary Column Operations</a></li>
<li><a href="sec1-3-echelon-form.html" data-scroll="sec1-3-echelon-form" class="internal">Echelon Forms</a></li>
<li><a href="sec1-4-matrix-rank.html" data-scroll="sec1-4-matrix-rank" class="internal">Rank of Matrices</a></li>
<li><a href="sec1-5-hom-system.html" data-scroll="sec1-5-hom-system" class="internal">Homogeneous System of Linear Equations</a></li>
<li><a href="sec1-6-LU.html" data-scroll="sec1-6-LU" class="internal"><span class="process-math">\(LU\)</span>-Facotorization</a></li>
<li><a href="sec1-7-exer.html" data-scroll="sec1-7-exer" class="internal">Exercises</a></li>
</ul>
</li>
<li class="link">
<a href="chap2-Rn-Space.html" data-scroll="chap2-Rn-Space" class="internal"><span class="codenumber">2</span> <span class="title"><span class="process-math">\(\R^n\)</span> as a Vector Space</span></a><ul>
<li><a href="sec2-0-intro.html" data-scroll="sec2-0-intro" class="internal">Introduction</a></li>
<li><a href="sec2-1-LinSpan.html" data-scroll="sec2-1-LinSpan" class="internal">Linear Spans</a></li>
<li><a href="sec-2-2-LI.html" data-scroll="sec-2-2-LI" class="internal">Linear Dependence</a></li>
<li><a href="sec-2-3-basis-dimension.html" data-scroll="sec-2-3-basis-dimension" class="internal">Basis and Dimension</a></li>
<li><a href="sec2-4-Sage.html" data-scroll="sec2-4-Sage" class="active">Sage Computations</a></li>
</ul>
</li>
<li class="link">
<a href="chap3-LT.html" data-scroll="chap3-LT" class="internal"><span class="codenumber">3</span> <span class="title">Linear Transformations</span></a><ul>
<li><a href="sec3-1-LT.html" data-scroll="sec3-1-LT" class="internal">Introduction</a></li>
<li><a href="sec3-2-LT.html" data-scroll="sec3-2-LT" class="internal">Linear maps from <span class="process-math">\(\R^n\)</span> to <span class="process-math">\(\R^m\)</span></a></li>
<li><a href="sec3-3-LT.html" data-scroll="sec3-3-LT" class="internal">Reflections and Projections</a></li>
<li><a href="sec-LT-Geom.html" data-scroll="sec-LT-Geom" class="internal">Geometry of Linear Transformations</a></li>
<li><a href="sec-sec3-5-LT-Sage.html" data-scroll="sec-sec3-5-LT-Sage" class="internal">Sage Computations</a></li>
</ul>
</li>
<li class="link">
<a href="chap4-Vector-Space.html" data-scroll="chap4-Vector-Space" class="internal"><span class="codenumber">4</span> <span class="title">Vector Spaces</span></a><ul>
<li><a href="sec4-1-VS.html" data-scroll="sec4-1-VS" class="internal">Introduction</a></li>
<li><a href="sec4-2-Abst-VS.html" data-scroll="sec4-2-Abst-VS" class="internal">Vector Subspaces</a></li>
<li><a href="sec4-3-linspan-VS.html" data-scroll="sec4-3-linspan-VS" class="internal">Linear Span</a></li>
<li><a href="sec4-3-LI-VS.html" data-scroll="sec4-3-LI-VS" class="internal">Linear dependence and independence</a></li>
<li><a href="sec4-5-basis-dim-VS.html" data-scroll="sec4-5-basis-dim-VS" class="internal">Basis and dimension</a></li>
<li><a href="sec-sec4-5-VS-Sage.html" data-scroll="sec-sec4-5-VS-Sage" class="internal">Sage Computations</a></li>
<li><a href="sec4-5-VS-Ex.html" data-scroll="sec4-5-VS-Ex" class="internal">Exercise Set</a></li>
</ul>
</li>
<li class="link">
<a href="chap5-Eigen.html" data-scroll="chap5-Eigen" class="internal"><span class="codenumber">5</span> <span class="title">Eigenvalues and Eigenvectors</span></a><ul>
<li><a href="sec5-1-eigen-intro.html" data-scroll="sec5-1-eigen-intro" class="internal">Eigenvalues and Eigenvectors</a></li>
<li><a href="sec5-2-diagonalization.html" data-scroll="sec5-2-diagonalization" class="internal">Diagonalization</a></li>
<li><a href="sec5-5-Eigen-Sage.html" data-scroll="sec5-5-Eigen-Sage" class="internal">Eigenvalues and Eigenvectors in Sage</a></li>
<li><a href="sec5-3-eigen-Appl.html" data-scroll="sec5-3-eigen-Appl" class="internal">Applications of Eigenvalues and Eigenvectors</a></li>
<li><a href="sec5-4-eigen-exer.html" data-scroll="sec5-4-eigen-exer" class="internal">Exercises on Eigenvalues and Eigenvectors</a></li>
</ul>
</li>
<li class="link">
<a href="chap5-orthogonality.html" data-scroll="chap5-orthogonality" class="internal"><span class="codenumber">6</span> <span class="title">Orthogonality</span></a><ul>
<li><a href="sec6-0-orthogonality.html" data-scroll="sec6-0-orthogonality" class="internal">Orthogonality</a></li>
<li><a href="sec6-1-GramSchmidt.html" data-scroll="sec6-1-GramSchmidt" class="internal">Gram-Schmidt Orthogonalization Process</a></li>
<li><a href="sec6-2.html" data-scroll="sec6-2" class="internal">Orthogonal Complements</a></li>
<li><a href="sec6-3.html" data-scroll="sec6-3" class="internal">Orthogonal Diagonalizations</a></li>
<li><a href="sec6-4.html" data-scroll="sec6-4" class="internal">QR-Factorization</a></li>
</ul>
</li>
<li class="link">
<a href="chap7-inner-product.html" data-scroll="chap7-inner-product" class="internal"><span class="codenumber">7</span> <span class="title">Inner Product</span></a><ul>
<li><a href="sec7-1-InnerProduct.html" data-scroll="sec7-1-InnerProduct" class="internal">Inner Product</a></li>
<li><a href="sec7-2-Exer.html" data-scroll="sec7-2-Exer" class="internal">Exercise Set</a></li>
</ul>
</li>
<li class="link">
<a href="chap8-Least-Square.html" data-scroll="chap8-Least-Square" class="internal"><span class="codenumber">8</span> <span class="title">Least Square Problems</span></a><ul><li><a href="sec8-1-LSTSQ.html" data-scroll="sec8-1-LSTSQ" class="internal">Least Square Problems</a></li></ul>
</li>
<li class="link">
<a href="chap9-SVD.html" data-scroll="chap9-SVD" class="internal"><span class="codenumber">9</span> <span class="title">Singular Value Decomposition</span></a><ul><li><a href="sec9-1-SVD.html" data-scroll="sec9-1-SVD" class="internal">Singular Value Decomposition</a></li></ul>
</li>
<li class="link">
<a href="chap10-PCA.html" data-scroll="chap10-PCA" class="internal"><span class="codenumber">10</span> <span class="title">Principal Component Analysis</span></a><ul>
<li><a href="sec10-1-PCA.html" data-scroll="sec10-1-PCA" class="internal">Principal Component Analysis</a></li>
<li><a href="sec10-2.html" data-scroll="sec10-2" class="internal">Applications of PCA</a></li>
<li><a href="sec10-3.html" data-scroll="sec10-3" class="internal">Sage Practice Area</a></li>
</ul>
</li>
<li class="link backmatter"><a href="backmatter.html" data-scroll="backmatter" class="internal"><span class="title">Backmatter</span></a></li>
<li class="link">
<a href="appendix-sage-into.html" data-scroll="appendix-sage-into" class="internal"><span class="codenumber">1</span> <span class="title">Introduction to Sage</span></a><ul>
<li><a href="subsection-47.html" data-scroll="subsection-47" class="internal">Introduction to SageMath</a></li>
<li><a href="getting-started-sagemath.html" data-scroll="getting-started-sagemath" class="internal">Getting Started with Sage</a></li>
<li><a href="subsec-sage-programming.html" data-scroll="subsec-sage-programming" class="internal">Programming in Sage</a></li>
<li><a href="subsec-plotting-sage.html" data-scroll="subsec-plotting-sage" class="internal">Plotting in Sage</a></li>
</ul>
</li>
<li class="link"><a href="colophon-2.html" data-scroll="colophon-2" class="internal"><span class="title">Colophon</span></a></li>
</ul></nav><div class="extras"><nav><a class="pretext-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="sec2-4-Sage"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.5</span> <span class="title">Sage Computations</span>
</h2>
<p id="p-344">In this section, we explain, how Sage can be used to deal with all the concepts that we have learned in this chapter. We use reduced row echelon form (RREF) as tool to deal with all the comoutations.</p>
<p id="p-345"><em class="alert">Vectors in Sage</em></p>
<p id="p-346">In keyword 'vector' to define vectors by mentioning the domain from which entries are taken and giving the entries in a list. We can plot vectors in 2 and 3 dimensions. We can define vectors with entries from rational numbers ('QQ'), real numbers ('RR'), complex numbers ('CC') and even finite fields 'GF(p^k)' where <span class="process-math">\(p\)</span>  is a prime number.</p>
<p id="p-347"><em class="alert">Vectors in <span class="process-math">\(\R^2\)</span></em></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-51"><script type="text/x-sage">u = vector([3,-1])
v = vector([-1,2])
u+v
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-52"><script type="text/x-sage">## We can mention the domain as QQ, RR, etc
u = vector(QQ, [3,-1]) # RR for real and CC for complex entries
v = vector(QQ, [-1,2])
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-53"><script type="text/x-sage"># Plotting 2d vectors
plot(u)+plot(v,color='red')+plot(u+v,color='green')
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-54"><script type="text/x-sage">p1=plot(u)
p2 = plot(v,color='red')
p3= plot(u+v,color='green')
l1 =line([u,u+v],linestyle="--",color='black')
l2 = line([v,u+v],linestyle="--",color='black')
p1+p2+p3+l1+l2
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-55"><script type="text/x-sage"># Linear combinations
a1 = 3
a2 = -2
w=a1*u+a2*v
w
</script></pre>
<p id="p-348"><em class="alert">Vectors in <span class="process-math">\(\R^3\)</span></em></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-56"><script type="text/x-sage">u = vector([3,-1,2])
v = vector([-1,2,1])
w = 2*u-3*v
print(w)
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-57"><script type="text/x-sage">## Plotting 3d-vectors
plot(u)+plot(v,color='red')+plot(u+v,color='green')
</script></pre>
<p id="p-349">Vector in higher dimension in Sage</p>
<p id="p-350">Vectors in hiher dimensions can be defined in a similar manner, we just need to increase the number of coordinates/components. Let us look at an example.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-58"><script type="text/x-sage">u = vector([1,-2,3,-4,5,7])
v = vector([2,1,3,1,-6,5])
w = vector([-3,0,2,0,5,-6])
print(2*u-3*v+w)
</script></pre>
<article class="example example-like" id="example-45"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.1</span><span class="period">.</span>
</h3>
<p id="p-351">Genarate five random vectors in <span class="process-math">\(\mathbb{R}^8\)</span> whose entries are random integers between -10 and 10. Also generate 5 random numbers (scalars) whihc are integers between -10 and 10. Find the linear combinations of these vectors with five scalars. <pre class="ptx-sagecell sagecell-sage" id="sage-59"><script type="text/x-sage">n = 8
v1 = vector([randint(-10,10) for i in range(n)])
v2 = vector([randint(-10,10) for i in range(n)])
v3 = vector([randint(-10,10) for i in range(n)])
v4 = vector([randint(-10,10) for i in range(n)])
v5 = vector([randint(-10,10) for i in range(n)])
B = [v1,v2,v3,v4,v5]
print(B)
a = [randint(-10,10) for i in range(5)]
print(a)
sum([a[i]*B[i] for i in range(5)])
</script></pre></p></article><article class="example example-like" id="example-46"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.2</span><span class="period">.</span>
</h3>
<p id="p-352"><p id="p-353">(i) Let us plot the linear span of a single vector <span class="process-math">\((3,2, -1)\)</span> in  <span class="process-math">\(\R^3\)</span> in Sage.</p> <p id="p-354">Let us also plot the linear span of two vectors <span class="process-math">\((3,2, -1), (-1,1,2)\)</span> in <span class="process-math">\(\R^3\)</span> in Sage.</p> <p id="p-355">This can be achieved by sage method 'parametric_plot3d' in sage.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-60"><script type="text/x-sage">v = vector([3,2, -1])
var('s')
pv = plot(v,color='red',thickness=3)
linspan = parametric_plot3d(s*v,(s,-2,2),axes=True,frame=False, color='black')
linspan+pv
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-61"><script type="text/x-sage">v1 = vector([3,2, -1])
v2 = vector([-1,1,2])
var('s,t')
pv1 = plot(v1,color='red',thickness=5)
pv2 = plot(v2,color='green',thickness=5)
linspan = parametric_plot3d(s*v1+t*v2,(s,-3,3),(t,-3,3),axes=True,frame=False,opacity=0.4)
linspan+pv1+pv2
</script></pre></p></article><p id="p-356"><em class="alert">Generating matrix from vectors:</em></p>
<p id="p-357">We can generate matrix from a given set of vectors its columns and rows. Let us look at an example.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-62"><script type="text/x-sage">v1 = vector([1,-1,2,3])
v2 = vector([2,1,0,3])
v3 = vector([-2,2,-1,2])
A = column_matrix([v1,v2,v3])
print(A)
B = column_matrix([v1,v2,v3]).T
print(B)
</script></pre>
<p id="p-358">Vector Spaces over rational or reals:</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-63"><script type="text/x-sage">V = VectorSpace(RR,5);
print(V)
V =RR^5 ## Same as VectorSpace(RR,5);
print(V)
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-64"><script type="text/x-sage">V = VectorSpace(QQ,5);
print(V)
V =QQ^5
print(V)
</script></pre>
<p id="p-359">In sage a vector space, <span class="process-math">\(V\)</span> has two methods V.random_element()  and V.an_element() that displays a random element and an element (fixed) of <span class="process-math">\(V\text{.}\)</span></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-65"><script type="text/x-sage">V =QQ^5
V.random_element()
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-66"><script type="text/x-sage">V =QQ^5
V.an_element()
</script></pre>
<p id="p-360">Linearly dependence and indepndence in Sage</p>
<article class="example example-like" id="example-47"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.3</span><span class="period">.</span>
</h3>
<p id="p-361">Let us generate some random 5 vectors, <span class="process-math">\(v_1,\ldots, v_5\)</span> in the vector space QQ^5. Sage has a method .are_linearly_dependent() to check if a set of vectors are linearly dependent. Sage also has a method linear_dependence() whihc return emply list in case the set is linearly independent and returns a list of scalars <span class="process-math">\(\alpha_i\)</span> such that <span class="process-math">\(\sum \alpha_i v_i=0\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-67"><script type="text/x-sage">V =QQ^5
v1 = vector(QQ,[1,-1,3,2,4])
v2 = vector(QQ,[-2,1,0,3,-1])
v3 = vector(QQ,[-5,3,-3,4,-6])
v4 = vector(QQ,[3,2,1,2,3])
v5 = vector(QQ,[-13,4,-7,6,-15])
B = [v1,v2,v3,v4,v5]
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-68"><script type="text/x-sage">V.are_linearly_dependent(B)
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-69"><script type="text/x-sage">V.linear_dependence(B)
</script></pre> <p id="p-362">Now we can check if the scalar linear combination of the output shown above with sect of vectors in <span class="process-math">\(B\)</span> is zero.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-70"><script type="text/x-sage">s = V.linear_dependence(B)
sum([s[1][i]*B[i] for i in range(len(B))])
</script></pre></p></article><article class="example example-like" id="example-48"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.4</span><span class="period">.</span><span class="space"> </span><span class="title">Linear Span of vectors in Sage.</span>
</h3>
<p id="p-363">Sage can generate a linear span of a set of vectors in a vector space using the vector space method .span(). Let us explore this for set of 5 vectors in a vector space V=QQ^4.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-71"><script type="text/x-sage">V =QQ^5
v1 = vector(QQ,[1,-1,3,2,4])
v2 = vector(QQ,[-2,1,0,3,-1])
v3 = vector(QQ,[-5,3,-3,4,-6])
v4 = vector(QQ,[3,2,1,2,3])
v5 = vector(QQ,[-13,4,-7,6,-15])
B = [v1,v2,v3,v4,v5]
W=V.span(B)
W
</script></pre>
<p id="p-364">It returns the dimension of the linear span along with a basis as a matrix. We can check if any linear combinations of vectors in B lies in W.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-72"><script type="text/x-sage">a = [randint(-10,10) for i in range(len(B))]
x = sum(a[i]*B[i] for i in range(len(B)))
x in W
</script></pre>
<p id="p-365">We can also check if W is a subspave of V using the following sage syntaxes.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-73"><script type="text/x-sage">W <= V
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-74"><script type="text/x-sage">W.is_subspace(V)
</script></pre></article><article class="example example-like" id="example-49"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.5</span><span class="period">.</span><span class="space"> </span><span class="title">Using RREF to find a basis of a linear span.</span>
</h3>
<p id="p-366">Let us use the sage method rref to find a basis of the set of vectors define earlies in Sage.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-75"><script type="text/x-sage">V =QQ^5
v1 = vector(QQ,[1,-1,3,2,4])
v2 = vector(QQ,[-2,1,0,3,-1])
v3 = vector(QQ,[-5,3,-3,4,-6])
v4 = vector(QQ,[3,2,1,2,3])
v5 = vector(QQ,[-13,4,-7,6,-15])
B = [v1,v2,v3,v4,v5]
# We define a matrix whose rows are v1,..., v5
M = column_matrix(B).T 
M.rref()
</script></pre>
<p id="p-367">Clearly the first three rows constitutes a basis of linear span. This is what we obtained using <code class="code-inline tex2jax_ignore">.span()</code>.</p></article><article class="example example-like" id="example-50"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.6</span><span class="period">.</span><span class="space"> </span><span class="title">Coordinates of a vector w.r.t. a basis.</span>
</h3>
<p id="p-368">Consider a set of vectors <span class="process-math">\(B = \{(1,-1,3,2), (-2,1,3,-1), (5,3,1,4),(3,2,1,2)\}\text{.}\)</span>Check if this forms a basis of the vector space <span class="process-math">\(V=\mathbb{Q}^5\text{.}\)</span> Find the coordinates of the vector <span class="process-math">\(v=(5,7,11,-13)\)</span> with respect to this basis.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-76"><script type="text/x-sage">V = QQ^4
# Returns the standard basis 
V.basis()
</script></pre>
<p id="p-369">We can also print this basis as a matrix using <code class="code-inline tex2jax_ignore">V.basis_matrix()</code></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-77"><script type="text/x-sage">V.basis_matrix()
</script></pre>
<p id="p-370">Now we define the set of vectors in Sage.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-78"><script type="text/x-sage">v1 = vector(QQ,[1,-1,3,2])
v2 = vector(QQ,[-2,1,3,-1])
v3 = vector(QQ,[5,3,1,4])
v4 = vector(QQ,[3,2,1,2])
B = [v1,v2,v3,v4]
V.linear_dependence(B)
</script></pre>
<p id="p-371">We can also check the same by finding the rank of the martrix <span class="process-math">\(M\)</span> whose columns and the given vectors. If the rank is 4, then the given set of vectors are linearly independet.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-79"><script type="text/x-sage">M = column_matrix(B)
M.rank()
</script></pre>
<p id="p-372">Since it returns an empty list. The given set of vectors <span class="process-math">\(B\)</span> is linearly independet. We can find the coordinates of the vector using sage method <code class="code-inline tex2jax_ignore">coordinate_vector()</code> or using <code class="code-inline tex2jax_ignore">.coordinates()</code> using  the following codes. For this first we need to create a subspace say V1 with B as a basis using the method <code class="code-inline tex2jax_ignore">V.subspace_with_basis(B)</code></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-80"><script type="text/x-sage">v = vector(QQ,[5,7,11,-13])
V1 = V.subspace_with_basis(B)
V1
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-81"><script type="text/x-sage">V1.coordinate_vector(v)
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-82"><script type="text/x-sage">V1.coordinates(v)
</script></pre>
<p id="p-373">We can also find the same manually using RREF as follows.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-83"><script type="text/x-sage">column_matrix(B).augment(v,subdivide=True)
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-84"><script type="text/x-sage">column_matrix(B).augment(v,subdivide=True).rref()
</script></pre>
<p id="p-374">The same can be achieved using by solving the system <span class="process-math">\(Bx=v\text{.}\)</span></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-85"><script type="text/x-sage">column_matrix(B).inverse()*v
</script></pre></article><article class="example example-like" id="fundamental-spaces-sage-eg1"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.7</span><span class="period">.</span><span class="space"> </span><span class="title">Fundamental subscapes of a matrix.</span>
</h3>
<p id="p-375">Consider a matrix <span class="process-math">\(A= \left(\begin{array}{rrrrrr}
-351 \amp  -1053 \amp  -1053 \amp  160 \amp  382 \amp  1657 \\
-32 \amp  -96 \amp  -96 \amp  15 \amp  35 \amp  152 \\
-36 \amp  -108 \amp  -108 \amp  16 \amp  39 \amp  169 \\
11 \amp  33 \amp  33 \amp  -5 \amp  -12 \amp  -52 \\
-11 \amp  -33 \amp  -33 \amp  5 \amp  12 \amp  52
\end{array}\right)\text{.}\)</span> Find the fundamental subspaces defined in the Example <a href="" class="xref" data-knowl="./knowl/sec2-1-matrix-spaces.html" title="Example 2.2.3: Matrix Spaces">Example 2.2.3</a></p>
<a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-15" id="solution-15"><span class="type">Solution</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-15"><div class="solution solution-like"><p id="p-376">First of all let us find the row space using the method <code class="code-inline tex2jax_ignore">.row_space()</code>. This returns the dimension and the basis matrix of the row space. This we can verify using rref applied to the matrix <span class="process-math">\(A\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-86"><script type="text/x-sage">     A =matrix([[-351, -1053 , -1053 , 160 , 382 , 1657 ], 
[-32 , -96 , -96 , 15 , 35 , 152 ],
[-36 , -108 , -108 , 16 , 39 , 169 ],
[11 , 33 , 33 , -5 , -12 , -52 ],
[-11 , -33 , -33 , 5 , 12 , 52]])
A.row_space()
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-87"><script type="text/x-sage">A.rref()
</script></pre> <p id="p-377">Clearly the first three row of rref(A) is same as basis matrix obtained uising the inbuilt sage method.</p> <p id="p-378">Next we find the columns space using the sage method <code class="code-inline tex2jax_ignore">A.column_space()</code> and verify the same using the rref applied to <span class="process-math">\(A^T\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-88"><script type="text/x-sage">## Column space of A
A.column_space()
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-89"><script type="text/x-sage">## Finding basis of column space using RREF
A.T.rref()
</script></pre> <p id="p-379">Clearly, the 1st three rows of rref(A) are same as basis matrix of <code class="code-inline tex2jax_ignore">A.column_space()</code></p> <p id="p-380">The column space of <span class="process-math">\(A\)</span> is also known as image space of <span class="process-math">\(A\text{.}\)</span> Sage has inbuilt method <code class="code-inline tex2jax_ignore">A.image()</code> to find the image space.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-90"><script type="text/x-sage">A.image()
</script></pre> <p id="p-381">The null space of <span class="process-math">\(A\)</span> also known as kernel of <span class="process-math">\(A\)</span> can be obtained by the sage method <code class="code-inline tex2jax_ignore">A.right_kernel()</code>.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-91"><script type="text/x-sage">A.right_kernel()
</script></pre> <p id="p-382">Clearly, the kernel is of dimension 3.</p> <p id="p-383">The left null space can be obtained by the sage method <code class="code-inline tex2jax_ignore">A.left_kernel()</code> or using <code class="code-inline tex2jax_ignore">A.T.right_kernel()</code>.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-92"><script type="text/x-sage">A.left_kernel()
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-93"><script type="text/x-sage">A.T.right_kernel()
</script></pre></p></div></div></article><article class="observation remark-like" id="observation-3"><h3 class="heading">
<span class="type">Observation</span><span class="space"> </span><span class="codenumber">2.5.8</span><span class="period">.</span>
</h3>
<p id="p-384">Consider the matrix <span class="process-math">\(A\)</span> defined in the Example <a href="" class="xref" data-knowl="./knowl/fundamental-spaces-sage-eg1.html" title="Example 2.5.7: Fundamental subscapes of a matrix">Example 2.5.7</a>. Observe the following:</p>
<p id="p-385">(i) Let <span class="process-math">\(u\)</span> be a random element in <span class="process-math">\(Row(A)\)</span> and <span class="process-math">\(v\)</span> be a random element in <span class="process-math">\(null(A)\text{.}\)</span> Then <span class="process-math">\(u\)</span> and <span class="process-math">\(v\)</span> are orthogoal. That is, <span class="process-math">\(u\cdot v=0\text{.}\)</span></p>
<p id="p-386">(ii) Let <span class="process-math">\(u\)</span> be a random element in <span class="process-math">\(Col(A)\)</span> and <span class="process-math">\(v\)</span> be a random element in <span class="process-math">\(leftnull(A)\text{.}\)</span> Then <span class="process-math">\(u\)</span> and <span class="process-math">\(v\)</span> are orthogoal. That is, <span class="process-math">\(u\cdot v=0\text{.}\)</span></p>
<a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-16" id="solution-16"><span class="type">Solution</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-16"><div class="solution solution-like"><p id="p-387"><pre class="ptx-sagecell sagecell-sage" id="sage-94"><script type="text/x-sage">A =matrix([[-351, -1053 , -1053 , 160 , 382 , 1657 ], 
[-32 , -96 , -96 , 15 , 35 , 152 ],
[-36 , -108 , -108 , 16 , 39 , 169 ],
[11 , 33 , 33 , -5 , -12 , -52 ],
[-11 , -33 , -33 , 5 , 12 , 52]])
rowA = A.row_space()
colA = A.column_space()
nullA = A.right_kernel()
leftnullA = A.left_kernel()
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-95"><script type="text/x-sage">u = rowA.random_element()
v = nullA.random_element()
u.dot_product(v)
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-96"><script type="text/x-sage">u = colA.random_element()
v = leftnullA.random_element()
u.dot_product(v)
</script></pre></p></div></div></article><article class="example example-like" id="example-52"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.9</span><span class="period">.</span><span class="space"> </span><span class="title">Change of coordinates.</span>
</h3>
<p id="p-388">Consider the vector space <span class="process-math">\(V=\mathbb{Q}^4\text{.}\)</span> Defines two subsets</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\beta=\{(-5, 8,  0, 4),(-3, 9, -2, 4),(-1, 4, -1, 2),(-1, 2,  0, 1)\}
\end{equation*}
</div>
<p class="continuation">and</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\gamma = \{(0,  2, -7,  5),(-1,  2, -1,  4),(1, -3,  5, -7),(1,  1, -8,  3)\}\text{.}
\end{equation*}
</div>
<p class="continuation">Check that <span class="process-math">\(\beta\)</span> and <span class="process-math">\(\gamma\)</span> are linearly independent hence they form bases of <span class="process-math">\(V\text{.}\)</span> Let <span class="process-math">\(x=(3,5,7,9)\in V\text{.}\)</span> Find the coordinates of <span class="process-math">\(x\)</span> with respect to <span class="process-math">\(\beta\)</span>  and <span class="process-math">\(\gamma\)</span> and denote them by <span class="process-math">\(x_\beta\)</span> and <span class="process-math">\(x_\gamma\)</span> respectively. Find the change of basis matrices <span class="process-math">\([I]_\beta^\gamma\)</span> and <span class="process-math">\([I]_\gamma^\beta\text{.}\)</span> Show that <span class="process-math">\(\left([I]_\beta^\gamma\right)^{-1}=[I]_\gamma^\beta\text{.}\)</span>  Also verify that <span class="process-math">\([I]_\beta^\gamma x_\beta=x_\gamma\)</span> and <span class="process-math">\([I]_\gamma^\beta x_\gamma=x_\beta\text{.}\)</span></p>
<a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-17" id="solution-17"><span class="type">Solution</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-17"><div class="solution solution-like"><p id="p-389"><pre class="ptx-sagecell sagecell-sage" id="sage-97"><script type="text/x-sage">V = QQ^4
b1 = vector(QQ, [-5, 8,  0, 4])
b2 = vector(QQ, [-3, 9, -2, 4])
b3 = vector(QQ, [-1, 4, -1, 2])
b4 = vector(QQ, [-1, 2,  0, 1])
B = [b1, b2, b3, b4]
V.are_linearly_dependent(B)
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-98"><script type="text/x-sage">c1 = vector(QQ, [ 0,  2, -7,  5])
c2 = vector(QQ, [-1,  2, -1,  4])
c3 = vector(QQ, [ 1, -3,  5, -7])
c4 = vector(QQ, [ 1,  1, -8,  3])
C = [c1, c2, c3,c4]
V.are_linearly_dependent(C)
</script></pre> <p id="p-390">Clearly B and C are linearly indendent and hence they are bases of <span class="process-math">\(V\text{.}\)</span></p> <p id="p-391">Next we define two subspaces V1 and V2 with B and C as bases respectively and define the vector <span class="process-math">\(x\)</span> in Sage.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-99"><script type="text/x-sage">V1 = V.subspace_with_basis(B)
V2 = V.subspace_with_basis(C)
x = vector([3,5,7,9])
</script></pre> <p id="p-392">Next we find the coordinates <span class="process-math">\(x_\beta\)</span> and <span class="process-math">\(x_\gamma\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-100"><script type="text/x-sage">xB = V1.coordinates(x);
print(f'The coordinates of x w.r.t. B is: {xB}')
xC = V2.coordinates(x);
print(f'The coordinates of x w.r.t. C is: {xC}')
</script></pre> <p id="p-393">Next we define the change of basis matrix <span class="process-math">\([I]_\beta^\gamma\text{.}\)</span> This can be achieved by taking a matrix <span class="process-math">\(M=[C~|~B]\)</span> applying rref and extracting the last four columns.</p> <pre class="ptx-sagecell sagecell-sage" id="sage-101"><script type="text/x-sage">## Matrix of Change of basis from B to C, that [I]_B^C
k = len(B)
M = column_matrix(C+B)
print(M)
M1 = M.rref()
print(M1)
IBC = M1.submatrix(0,k)
print(IBC)
</script></pre> <p id="p-394">One can verify that this is same as <span class="process-math">\(C^{-1}B\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-102"><script type="text/x-sage">column_matrix(C).inverse()*column_matrix(B)==IBC
</script></pre> <p id="p-395">Next we define the change of basis matrix <span class="process-math">\([I]_\gamma^\beta\text{.}\)</span> This can be achieved by taking a matrix <span class="process-math">\(M=[B~|~C]\)</span> applying rref and extracting the last four columns. One can verify that this is same as <span class="process-math">\(C^{-1}B\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-103"><script type="text/x-sage">## Matrix of Change of basis from C to B, that [I]_C^B
k = len(B)
M = column_matrix(B+C)
print(M)
M1 = M.rref()
print(M1)
ICB = M1.submatrix(0,k)
print(ICB)
</script></pre> <pre class="ptx-sagecell sagecell-sage" id="sage-104"><script type="text/x-sage">column_matrix(B).inverse()*column_matrix(C)==ICB
</script></pre> <p id="p-396">Let us check that <span class="process-math">\(\left([I]_\beta^\gamma\right)^{-1}=[I]_\gamma^\beta\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-105"><script type="text/x-sage">IBC.inverse()==ICB
</script></pre> <p id="p-397">Finally we show that <span class="process-math">\([I]_\beta^\gamma x_\beta=x_\gamma\)</span> and <span class="process-math">\([I]_\gamma^\beta x_\gamma=x_\beta\text{.}\)</span></p> <pre class="ptx-sagecell sagecell-sage" id="sage-106"><script type="text/x-sage">IBC*vector(xB)==vector(xC)
ICB*vector(xC)==vector(xB)
</script></pre></p></div></div></article><article class="example example-like" id="example-53"><h3 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.5.10</span><span class="period">.</span><span class="space"> </span><span class="title">Sum and intersection of subspaces.</span>
</h3>
<p id="p-398">Let <span class="process-math">\(u_1=\left(2,-1,0,3,1,2\right)\text{,}\)</span> <span class="process-math">\(u_2=\left(-1,2,0,-6,-2,-1\right)\text{,}\)</span> <span class="process-math">\(u_3=\left(5,-6,-2,18,3,6\right)\)</span> and <span class="process-math">\(u_4=\left(-12,18,6,-54,-9,-15\right)\text{.}\)</span> Let <span class="process-math">\(W_1=L(\{u_1,u_2,u_3,u_4\})\text{.}\)</span></p>
<p id="p-399">Let <span class="process-math">\(v_1=\left(-1,4,2,-12,-1,-2\right)\text{,}\)</span> <span class="process-math">\(v_2=\left(1,2,-1,3,2,1\right)\text{,}\)</span> <span class="process-math">\(v_3=\left(22,-30,-10,90,15,27\right)\text{,}\)</span> <span class="process-math">\(v_4=\left(19,-24,-5,63,11,22\right)\)</span> and <span class="process-math">\(v_5=\left(-1,2,0,-1,3,0\right)\text{.}\)</span> Let  <span class="process-math">\(W_2=L(\{v_1,v_2,v_3,v_4,v_5\})\text{.}\)</span></p>
<p id="p-400">Find the subspaces <span class="process-math">\(W_1\cap W_2\)</span> and <span class="process-math">\(W_1+W_2\text{.}\)</span></p>
<div class="solutions">
<a href="" data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-18" id="solution-18"><span class="type">Solution</span><span class="period">.</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-18"><div class="solution solution-like">
<p id="p-401">Sage has inbulit method to find sum and intersection of two subspaces. However, shall also see how these can be obtained manually.</p>
<p id="p-402">First of all we define <span class="process-math">\(W_1=L(S_1)\text{.}\)</span></p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-107"><script type="text/x-sage">v1 = vector(QQ,[2,-1,0,3,1,2])
v2 = vector(QQ,[-1, 2, 0, -6, -2,-1])
v3 = vector(QQ,[5, -6, -2, 18, 3, 6])
v4 = vector(QQ,[-12, 18, 6, -54, -9, -15])
W1 = V.span([v1,v2,v3,v4]);W1
</script></pre>
<p id="p-403">This show that <span class="process-math">\(W_1\)</span> is a 3-dimensional subspace of <span class="process-math">\(V\text{.}\)</span></p>
<p id="p-404">Next, we define <span class="process-math">\(W_2=L(S_2)\)</span></p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-108"><script type="text/x-sage">u1 = vector(QQ,[-1, 4, 2, -12, -1, -2])
u2 = vector(QQ,[1,2,-1,3,2,1])
u3 = vector(QQ,[22, -30, -10, 90, 15, 27])
u4 = vector(QQ,[19, -24, -5, 63, 11, 22])
u5 = vector([-1,2,0,-1,3,0])
W2 = V.span([u1,u2,u3,u4,u5]);W2
</script></pre>
<p id="p-405">Here <span class="process-math">\(W_2\)</span> is a 4 dimensional subspace of <span class="process-math">\(V\text{.}\)</span></p>
<p id="p-406">Now we find <span class="process-math">\(W_1\cap W_2\)</span> using the Sage method <code class="code-inline tex2jax_ignore">W1.intersection(W2)</code>.</p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-109"><script type="text/x-sage">U = W1.intersection(W2);U
</script></pre>
<p id="p-407">Next we can find <span class="process-math">\(W_1+W_2\)</span> as follows.</p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-110"><script type="text/x-sage">Z = W1+W2;Z
</script></pre>
<p id="p-408">From the above computations, it is clear that</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\dim(W_1+W_2)=\dim(W_1)+\dim(W_2)-\dim(W_1\cap W_2)\text{.}
\end{equation*}
</div>
<p class="continuation">In fact, this is true in general and we shall prove this later.</p>
<p id="p-409"><em class="alert">How to find <span class="process-math">\(W_1+W_2\)</span> manually?</em></p>
<p id="p-410">This can be obtained as <span class="process-math">\(L(S_1\cup S_2)\text{.}\)</span> Thus we can construct a matrix <span class="process-math">\(M\)</span> whose rows are <span class="process-math">\(S_1\cup S_2\)</span> and apply RREF. Let us see this.</p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-111"><script type="text/x-sage">M = column_matrix([v1,v2,v3,v4,u1,u2,u3,u4,u5]).T
M.rref()
</script></pre>
<p id="p-411">Clearly the first 5 rows of RREF(M) is the basis matrix obtained for <span class="process-math">\(W_1+W_2\text{.}\)</span></p>
<p id="p-412">Finding <span class="process-math">\(W_1\cap W_2\)</span> manually.</p>
<p id="p-413">Let <span class="process-math">\(c_1,c_2, c_3\)</span> be a basis of <span class="process-math">\(W_1\)</span>   and <span class="process-math">\(d_1,d_2, d_3,d_4\)</span> be a  basis of <span class="process-math">\(W_2\)</span> obtined above. If  <span class="process-math">\(v\in W_1\cap W_2\text{.}\)</span> Then</p>
<div class="displaymath process-math" data-contains-math-knowls="" id="p-414">
\begin{equation*}
v=\alpha_1c_1+\alpha_2c_2+\alpha_3c_3=\beta_1d_1+\beta_2d_2+\beta_3d_3+\beta_4 d_4\text{.}
\end{equation*}
</div>
<p id="p-415">In particular, <span class="process-math">\(\alpha_1c_1+\alpha_2c_2+\alpha_3c_3-\beta_1d_1-\beta_2d_2-\beta_3d_3-\beta_4 d_4=0\text{.}\)</span>  We can obtain <span class="process-math">\(\alpha_i\)</span>'s and <span class="process-math">\(\beta_i\)</span>'s by solving</p>
<div class="displaymath process-math" data-contains-math-knowls="" id="p-416">
\begin{equation*}
\begin{bmatrix} c_1 \amp c_2\amp c_3\amp d_1\amp d_2\amp d_3 \amp d_4\end{bmatrix}
\begin{pmatrix} \alpha_1 \\ \alpha_2\\ \alpha_3\\ \beta_1\\ \beta_2\\ \beta_3\\\beta_4\end{pmatrix}=0
\end{equation*}
</div>
<p id="p-417">Thus we can find the null space of <span class="process-math">\(\begin{bmatrix} c_1 \amp c_2\amp c_3\amp d_1\amp d_2\amp d_3 \amp d_4\end{bmatrix}\)</span> and find the vectors in the basis of <span class="process-math">\(W_1\cap W_2\text{.}\)</span> Let see how to do this in Sage.</p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-112"><script type="text/x-sage">P = column_matrix([c[i] for i in range(len(c))]+[d[i] for i in range(len(d))]).T;
a = P.kernel().basis()
print(a)
</script></pre>
<p id="p-418">Once we have the basis of <span class="process-math">\(null(P)\text{,}\)</span> we can obained the basis vector in <span class="process-math">\(W_1\cap W_2\)</span> as follows.</p>
<pre class="ptx-sagecell hidden-sagecell-sage" id="sage-113"><script type="text/x-sage">f1=sum([a[0][i]*c[i] for i in range(len(c))]) 
f2=sum([a[1][i]*c[i] for i in range(len(c))]) 
print(f2)
print(f1)
</script></pre>
<p id="p-419">Clearly these are the basis vectors for <span class="process-math">\(W_1\cap W_2\)</span> obtained using the inbulit Sage method.</p>
</div></div>
</div></article></section></div></main>
</div>
</body>
</html>
