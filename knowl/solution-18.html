<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2025-08-18T19:42:31+05:30       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script>
</head>
<body class="ignore-math">
<div class="solution solution-like">
<h3 class="heading">
<span class="type">Solution</span><span class="space"> </span><span class="codenumber">2.5.10.1</span><span class="period">.</span>
</h3>
<p>Sage has inbulit method to find sum and intersection of two subspaces. However, shall also see how these can be obtained manually.</p>
<p>First of all we define <span class="process-math">\(W_1=L(S_1)\text{.}\)</span></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-107"><script type="text/x-sage">v1 = vector(QQ,[2,-1,0,3,1,2])
v2 = vector(QQ,[-1, 2, 0, -6, -2,-1])
v3 = vector(QQ,[5, -6, -2, 18, 3, 6])
v4 = vector(QQ,[-12, 18, 6, -54, -9, -15])
W1 = V.span([v1,v2,v3,v4]);W1
</script></pre>
<p>This show that <span class="process-math">\(W_1\)</span> is a 3-dimensional subspace of <span class="process-math">\(V\text{.}\)</span></p>
<p>Next, we define <span class="process-math">\(W_2=L(S_2)\)</span></p>
<pre class="ptx-sagecell sagecell-sage" id="sage-108"><script type="text/x-sage">u1 = vector(QQ,[-1, 4, 2, -12, -1, -2])
u2 = vector(QQ,[1,2,-1,3,2,1])
u3 = vector(QQ,[22, -30, -10, 90, 15, 27])
u4 = vector(QQ,[19, -24, -5, 63, 11, 22])
u5 = vector([-1,2,0,-1,3,0])
W2 = V.span([u1,u2,u3,u4,u5]);W2
</script></pre>
<p>Here <span class="process-math">\(W_2\)</span> is a 4 dimensional subspace of <span class="process-math">\(V\text{.}\)</span></p>
<p>Now we find <span class="process-math">\(W_1\cap W_2\)</span> using the Sage method <code class="code-inline tex2jax_ignore">W1.intersection(W2)</code>.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-109"><script type="text/x-sage">U = W1.intersection(W2);U
</script></pre>
<p>Next we can find <span class="process-math">\(W_1+W_2\)</span> as follows.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-110"><script type="text/x-sage">Z = W1+W2;Z
</script></pre>
<p>From the above computations, it is clear that</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\dim(W_1+W_2)=\dim(W_1)+\dim(W_2)-\dim(W_1\cap W_2)\text{.}
\end{equation*}
</div>
<p class="continuation">In fact, this is true in general and we shall prove this later.</p>
<p><em class="alert">How to find <span class="process-math">\(W_1+W_2\)</span> manually?</em></p>
<p>This can be obtained as <span class="process-math">\(L(S_1\cup S_2)\text{.}\)</span> Thus we can construct a matrix <span class="process-math">\(M\)</span> whose rows are <span class="process-math">\(S_1\cup S_2\)</span> and apply RREF. Let us see this.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-111"><script type="text/x-sage">M = column_matrix([v1,v2,v3,v4,u1,u2,u3,u4,u5]).T
M.rref()
</script></pre>
<p>Clearly the first 5 rows of RREF(M) is the basis matrix obtained for <span class="process-math">\(W_1+W_2\text{.}\)</span></p>
<p>Finding <span class="process-math">\(W_1\cap W_2\)</span> manually.</p>
<p>Let <span class="process-math">\(c_1,c_2, c_3\)</span> be a basis of <span class="process-math">\(W_1\)</span>   and <span class="process-math">\(d_1,d_2, d_3,d_4\)</span> be a  basis of <span class="process-math">\(W_2\)</span> obtined above. If  <span class="process-math">\(v\in W_1\cap W_2\text{.}\)</span> Then</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
v=\alpha_1c_1+\alpha_2c_2+\alpha_3c_3=\beta_1d_1+\beta_2d_2+\beta_3d_3+\beta_4 d_4\text{.}
\end{equation*}
</div>
<p>In particular, <span class="process-math">\(\alpha_1c_1+\alpha_2c_2+\alpha_3c_3-\beta_1d_1-\beta_2d_2-\beta_3d_3-\beta_4 d_4=0\text{.}\)</span>  We can obtain <span class="process-math">\(\alpha_i\)</span>'s and <span class="process-math">\(\beta_i\)</span>'s by solving</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\begin{bmatrix} c_1 \amp c_2\amp c_3\amp d_1\amp d_2\amp d_3 \amp d_4\end{bmatrix}
\begin{pmatrix} \alpha_1 \\ \alpha_2\\ \alpha_3\\ \beta_1\\ \beta_2\\ \beta_3\\\beta_4\end{pmatrix}=0
\end{equation*}
</div>
<p>Thus we can find the null space of <span class="process-math">\(\begin{bmatrix} c_1 \amp c_2\amp c_3\amp d_1\amp d_2\amp d_3 \amp d_4\end{bmatrix}\)</span> and find the vectors in the basis of <span class="process-math">\(W_1\cap W_2\text{.}\)</span> Let see how to do this in Sage.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-112"><script type="text/x-sage">P = column_matrix([c[i] for i in range(len(c))]+[d[i] for i in range(len(d))]).T;
a = P.kernel().basis()
print(a)
</script></pre>
<p>Once we have the basis of <span class="process-math">\(null(P)\text{,}\)</span> we can obained the basis vector in <span class="process-math">\(W_1\cap W_2\)</span> as follows.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-113"><script type="text/x-sage">f1=sum([a[0][i]*c[i] for i in range(len(c))]) 
f2=sum([a[1][i]*c[i] for i in range(len(c))]) 
print(f2)
print(f1)
</script></pre>
<p>Clearly these are the basis vectors for <span class="process-math">\(W_1\cap W_2\)</span> obtained using the inbulit Sage method.</p>
</div>
<span class="incontext"><a href="sec2-4-Sage.html#solution-18" class="internal">in-context</a></span>
</body>
</html>
