<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="example example-like"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">9.1.4</span><span class="period">.</span>
</h4>
<div class="para">Let us find a singular value decomposition of <span class="process-math">\(A= \begin{pmatrix}3 \amp 2 \amp 2 \\ 2 \amp 3 \amp -2 \end{pmatrix}\text{.}\)</span>
</div> <div class="para logical">
<div class="para">We have <span class="process-math">\(A^TA=\begin{pmatrix}13 \amp  12 \amp  2 \\ 12 \amp  13 \amp  -2 \\ 2 \amp  -2 \amp  8 \end{pmatrix}\text{.}\)</span> The eigenvalues of <span class="process-math">\(A^TA\)</span> are <span class="process-math">\(\sigma_1^2=25, \sigma_2^2=9\)</span> and <span class="process-math">\(\sigma_3^2=0\text{.}\)</span> The corresponding eigenvectors with respect to eigenvalues <span class="process-math">\(25,9, 0\)</span> of <span class="process-math">\(A^TA\)</span> are <span class="process-math">\(\begin{pmatrix}1\\1\\0 \end{pmatrix}\text{,}\)</span> <span class="process-math">\(\begin{pmatrix}1\\-1\\4 \end{pmatrix}\)</span> and <span class="process-math">\(\begin{pmatrix}1\\-1\\-\frac{1}{2} \end{pmatrix}\)</span> respectively. Hence an orthonormal eigenbasis of <span class="process-math">\(A^TA\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
\{v_1,v_2,v_3\}=\left\{\begin{pmatrix}1/\sqrt{2}\\1/\sqrt{2}\\0 \end{pmatrix} , \begin{pmatrix}1/\sqrt{18}\\-1/\sqrt{18}\\4/\sqrt{18} \end{pmatrix} , \begin{pmatrix}2/3\\-2/3\\-1/3 \end{pmatrix} \right\}\text{.}
\end{equation*}
</div>
</div> <div class="para logical">
<div class="para">We define</div>
<div class="displaymath process-math">
\begin{equation*}
u_1:=\frac{1}{\sigma_1}Av_1=\begin{pmatrix}1/\sqrt{2}\\1/\sqrt{2} \end{pmatrix} \text{ and } 
u_2:= \frac{1}{\sigma_2}Av_2=\begin{pmatrix}1/\sqrt{2}\\-1/\sqrt{2} \end{pmatrix}\text{.}
\end{equation*}
</div>
</div> <div class="para logical">
<div class="para">Thus we have</div>
<div class="displaymath process-math">
\begin{equation*}
U=\begin{pmatrix}\frac{1}{2} \, \sqrt{2} \amp  \frac{1}{2} \, \sqrt{2} \\ \frac{1}{2} \, \sqrt{2} \amp  -\frac{1}{2} \, \sqrt{2} \end{pmatrix} 
\end{equation*}
</div>
<div class="displaymath process-math">
\begin{equation*}
V=\begin{pmatrix}\frac{1}{2} \, \sqrt{2} \amp  \frac{1}{6} \, \sqrt{2} \amp  \frac{2}{3} \\\frac{1}{2} \, \sqrt{2} \amp  -\frac{1}{6} \, \sqrt{2} \amp -\frac{2}{3} \\ 0 \amp  \frac{2}{3} \, \sqrt{2} \amp  -\frac{1}{3} \end{pmatrix}  \text{ and } \sum = \begin{pmatrix}5 \amp  0 \amp  0 \\ 0 \amp  3 \amp  0 \end{pmatrix}\text{.}
\end{equation*}
</div>
</div> <div class="para">It is easy to check that that <span class="process-math">\(UAV^T=\sum\text{.}\)</span>
</div> <div id="eg_svd1-1-6" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">A = matrix([[3,2,2],[2,3,-2]])
print('A^TA is:' )
ATA = A.T*A
print(ATA)
print('Eigenvalues of A^TA are:')
evals = ATA.eigenvalues()
print(evals)
V=[]
evecs = ATA.eigenvectors_right()
for i in range(len(evecs)):
    print(f'The eigenvector with respect to eigenvalue {evecs[i][0]} is {evecs[i][1][0]}')
    v = evecs[i][1][0]/norm(evecs[i][1][0])
    V.append(v)
V = column_matrix(V)
print('The matrix V is:')
print(V)
u1 = A*V.columns()[0]/sqrt(evals[0])
u2 = A*V.columns()[1]/sqrt(evals[1])
U = column_matrix([u1,u2]);
print('The matrix U is:')
print(U)
S = zero_matrix(A.dimensions()[0],A.dimensions()[1])
for i in range(A.rank()):
    S[i,i]=sqrt(evals[i])
print('The matrix S is:')
print(S)
print('Check if U*S*V^T==A')
print(U*S*V.T==A)
</script></div></article><span class="incontext"><a class="internal" href="sec9-1-SVD.html#eg_svd1">in-context</a></span>
</body>
</html>
