<!DOCTYPE html>
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2025-08-18T19:42:32+05:30       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script>
</head>
<body class="ignore-math">
<article class="example example-like"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">8.1.4</span><span class="period">.</span>
</h4>
<p>The average annual temperature of Santacruz in Mumbai recorded from 1991 to 2021 is given in the following table.</p>
<p><div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Year</td>
<td class="l m b0 r0 l0 t0 lines">1990</td>
<td class="l m b0 r0 l0 t0 lines">1991</td>
<td class="l m b0 r0 l0 t0 lines">1992</td>
<td class="l m b0 r0 l0 t0 lines">1993</td>
<td class="l m b0 r0 l0 t0 lines">1994</td>
<td class="l m b0 r0 l0 t0 lines">1995</td>
<td class="l m b0 r0 l0 t0 lines">1996</td>
<td class="l m b0 r0 l0 t0 lines">1997</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Temp</td>
<td class="l m b0 r0 l0 t0 lines">27.07</td>
<td class="l m b0 r0 l0 t0 lines">26.93</td>
<td class="l m b0 r0 l0 t0 lines">27.11</td>
<td class="l m b0 r0 l0 t0 lines">27.18</td>
<td class="l m b0 r0 l0 t0 lines">26.94</td>
<td class="l m b0 r0 l0 t0 lines">27.25</td>
<td class="l m b0 r0 l0 t0 lines">27.64</td>
<td class="l m b0 r0 l0 t0 lines">27.66</td>
</tr>
<tr>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Year</td>
<td class="l m b0 r0 l0 t0 lines">1998</td>
<td class="l m b0 r0 l0 t0 lines">1999</td>
<td class="l m b0 r0 l0 t0 lines">2000</td>
<td class="l m b0 r0 l0 t0 lines">2001</td>
<td class="l m b0 r0 l0 t0 lines">2002</td>
<td class="l m b0 r0 l0 t0 lines">2003</td>
<td class="l m b0 r0 l0 t0 lines">2004</td>
<td class="l m b0 r0 l0 t0 lines">2005</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Temp</td>
<td class="l m b0 r0 l0 t0 lines">27.75</td>
<td class="l m b0 r0 l0 t0 lines">27.65</td>
<td class="l m b0 r0 l0 t0 lines">27.61</td>
<td class="l m b0 r0 l0 t0 lines">27.26</td>
<td class="l m b0 r0 l0 t0 lines">27.82</td>
<td class="l m b0 r0 l0 t0 lines">27.46</td>
<td class="l m b0 r0 l0 t0 lines">27.00</td>
<td class="l m b0 r0 l0 t0 lines">27.36</td>
</tr>
<tr>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Year</td>
<td class="l m b0 r0 l0 t0 lines">2006</td>
<td class="l m b0 r0 l0 t0 lines">2007</td>
<td class="l m b0 r0 l0 t0 lines">2008</td>
<td class="l m b0 r0 l0 t0 lines">2009</td>
<td class="l m b0 r0 l0 t0 lines">2010</td>
<td class="l m b0 r0 l0 t0 lines">2011</td>
<td class="l m b0 r0 l0 t0 lines">2012</td>
<td class="l m b0 r0 l0 t0 lines">2013</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Temp</td>
<td class="l m b0 r0 l0 t0 lines">27.36</td>
<td class="l m b0 r0 l0 t0 lines">28.02</td>
<td class="l m b0 r0 l0 t0 lines">27.75</td>
<td class="l m b0 r0 l0 t0 lines">28.33</td>
<td class="l m b0 r0 l0 t0 lines">28.16</td>
<td class="l m b0 r0 l0 t0 lines">27.94</td>
<td class="l m b0 r0 l0 t0 lines">27.61</td>
<td class="l m b0 r0 l0 t0 lines">27.63</td>
</tr>
<tr>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Year</td>
<td class="l m b0 r0 l0 t0 lines">2014</td>
<td class="l m b0 r0 l0 t0 lines">2015</td>
<td class="l m b0 r0 l0 t0 lines">2016</td>
<td class="l m b0 r0 l0 t0 lines">2017</td>
<td class="l m b0 r0 l0 t0 lines">2018</td>
<td class="l m b0 r0 l0 t0 lines">2019</td>
<td class="l m b0 r0 l0 t0 lines">2020</td>
<td class="l m b0 r0 l0 t0 lines">2021</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">Temp</td>
<td class="l m b0 r0 l0 t0 lines">28.18</td>
<td class="l m b0 r0 l0 t0 lines">28.67</td>
<td class="l m b0 r0 l0 t0 lines">28.24</td>
<td class="l m b0 r0 l0 t0 lines">28.55</td>
<td class="l m b0 r0 l0 t0 lines">28.76</td>
<td class="l m b0 r0 l0 t0 lines">28.27</td>
<td class="l m b0 r0 l0 t0 lines">28.40</td>
<td class="l m b0 r0 l0 t0 lines">28.48</td>
</tr>
<tr>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
<td class="l m b1 r0 l0 t0 lines"></td>
</tr>
</table></div></p>
<p>Find the equation of the line that best fits these data points.</p>
<p>The temperature data is plotted in the <a href="" class="xref" data-knowl="./knowl/fig_mumtempplot.html" title="Figure 8.1.5">FigureÂ 8.1.5</a>.</p>
<figure class="figure figure-like"><div class="image-box" style="width: 70%; margin-left: 15%; margin-right: 15%;"><img src="external/images/mum_temp_plot.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">8.1.5<span class="period">.</span></span><span class="space"> </span></figcaption></figure><p>We wish to find the best fit line to the given set of data. Suppose the line is given by <span class="process-math">\(y=c+mx\text{,}\)</span> then we wish to find <span class="process-math">\(a\)</span> and <span class="process-math">\(b\)</span> such that the line <span class="process-math">\(y=c+mx\)</span> is best fit. Now what is meaning of "best fit". Suppose we consider the point <span class="process-math">\((x_i,y_i)\text{,}\)</span> if it lies on <span class="process-math">\(c+mx\text{,}\)</span> then <span class="process-math">\(y=c+mx_i\text{,}\)</span> other wise <span class="process-math">\(|(c+mx_i)-y_i|\)</span> is the error. We need to minimize this error for all the points. That is achieved by minimizing the sum of errors. Which is given by</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\sum_{i=1}^n [(c+mx_i)-y_i]^2
\end{equation*}
</div>
<p class="continuation">where <span class="process-math">\(n\)</span> is the number of points. Note that the sum of error squares can be written as</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\sum_{i=1}^n [(c+mx_i)-y_i]^2 = \norm{\begin{bmatrix}1 \amp  x_1 \\1 \amp  x_2 \\\vdots \amp  \vdots \\ 1 \amp x_n \end{bmatrix}  \begin{bmatrix}c\\m \end{bmatrix}  -\begin{bmatrix}y_1\\y_2\\\vdots\\y_n \end{bmatrix} }=\norm{Ax-b}\text{.}
\end{equation*}
</div>
<p>Here</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
A = \begin{bmatrix}1 \amp  x_1 \\1 \amp  x_2 \\\vdots \amp  \vdots \\ 1 \amp x_n \end{bmatrix}  x= \begin{bmatrix}c\\m \end{bmatrix} ,b = \begin{bmatrix}y_1\\y_2\\\vdots\\y_n \end{bmatrix}
\end{equation*}
</div>
<p>Thus finding <span class="process-math">\(m,c\)</span> amount to finding the least square solution of <span class="process-math">\(Ax=b\text{,}\)</span> which is given by</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
x^*=\begin{bmatrix}c\\m \end{bmatrix} =(A^TA)^{-1}A^Tb
\end{equation*}
</div>
<p>For the given problem, we have</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
A = \begin{bmatrix}1 \amp  1990 \\1 \amp  1991 \\\vdots \amp  \vdots \\ 1 \amp 2021 \end{bmatrix} , b = \begin{bmatrix}27.07\\26.93\\\vdots\\28.48 \end{bmatrix}
\end{equation*}
</div>
<p>We have</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
A^T = \left(\begin{array}{rr} 32 \amp  64176 \\ 64176 \amp  128707696 \end{array} \right), A^Tb =\left(\begin{array}{r} 888.050000000000 \\ 1.78111456000000 \times 10^{6} \end{array} \right)
\end{equation*}
</div>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
(A^TA)^{-1}=\left(\begin{array}{rr} \frac{8044231}{5456} \amp  -\frac{4011}{5456} \\ -\frac{4011}{5456} \amp  \frac{1}{2728} \end{array} \right)\text{.}
\end{equation*}
</div>
<p>Hence</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
x^*=\begin{bmatrix}c\\m \end{bmatrix} =(A^TA)^{-1}A^Tb = \left(\begin{array}{r} -68.0279710416216 \\ 0.0477584310854127 \end{array} \right)
\end{equation*}
</div>
<p>The set of points along with the best fitted line is shown in the <a href="" class="xref" data-knowl="./knowl/fig_mumtempplot2.html" title="Figure 8.1.6">FigureÂ 8.1.6</a></p>
<figure class="figure figure-like"><div class="image-box" style="width: 70%; margin-left: 15%; margin-right: 15%;"><img src="external/images/mum_temp_plot2.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">8.1.6<span class="period">.</span></span><span class="space"> </span></figcaption></figure><pre class="ptx-sagecell sagecell-sage" id="sage-282"><script type="text/x-sage">year=[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,
      2013,2014,2015,2016,2017,2018,2019,2020,2021]
temp=[27.08,26.93,27.11,27.18,26.94,27.25,27.64,27.66,27.75,27.65,27.61,27.26,27.82,
      27.46,27.00,27.36,27.36,28.02,27.75,28.33,28.16,27.94,27.61,27.63,28.18,28.67,28.24,28.55,
      28.76,28.27,28.40,28.48]
data = zip(year,temp)
point2d(data,figsize=8)
</script></pre>
<pre class="ptx-sagecell sagecell-sage" id="sage-283"><script type="text/x-sage">n = len(year);n
ones = [1]*n
A = column_matrix([ones,year])
b = column_matrix(temp)
s = (A.T*A).inverse()*A.T*b
print("The least square solution is give by:")
print(s)
</script></pre>
<p>This means the slope of the fitted (regression line) is 0.0477584310854127 and the intercept is -68.0279710416216. Now we plot the fitted line along with the fitted line.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-284"><script type="text/x-sage">var('t')
data1 = [(year[i],temp[i]) for i in range(n)]
point(data1,figsize=5)+plot((s[0]+s[1]*t)[0],(t,1990,2022),color='red',figsize=5)
</script></pre>
<p>Sage also has an inbult function to find the fitted line.</p>
<pre class="ptx-sagecell sagecell-sage" id="sage-285"><script type="text/x-sage">    ## Using Sage inbult function
var('t,a,b')
model(t) = a+b*t
data1 = [(year[i],temp[i]) for i in range(n)]
fit = find_fit(data1,model, solution_dict = True)
print(fit)
</script></pre></article><span class="incontext"><a href="sec8-1-LSTSQ.html#example-188" class="internal">in-context</a></span>
</body>
</html>
